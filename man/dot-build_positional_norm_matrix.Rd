% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential-analysis.R
\name{.build_positional_norm_matrix}
\alias{.build_positional_norm_matrix}
\title{Build normalization factor matrix with positional offsets}
\usage{
.build_positional_norm_matrix(
  pos_effect_data,
  count_matrix,
  size_factors,
  condition_data,
  reference_level
)
}
\arguments{
\item{pos_effect_data}{A data frame with \code{SEQUENCE} and \code{pos_effect} columns,
or a named list of such data frames keyed by condition.}

\item{count_matrix}{The count matrix (used for row/column names).}

\item{size_factors}{Named numeric vector of per-sample size factors.}

\item{condition_data}{Data frame with a \code{condition} column, rownames matching
column names of \code{count_matrix}.}

\item{reference_level}{Character. Condition level whose samples get
pos_effect = 0.}
}
\value{
A numeric matrix of normalization factors with the same dimensions
as \code{count_matrix}.
}
\description{
Constructs a normalization factor matrix where reference samples get
pos_effect = 0 and screen samples get condition-specific (or shared)
positional biases.
}
\keyword{internal}
