% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential-analysis.R
\name{test_position_corrected}
\alias{test_position_corrected}
\title{Test variants using position-corrected ratios}
\usage{
test_position_corrected(
  data,
  neutral_variants = c("synonymous_variant"),
  fdr_threshold = 0.01
)
}
\arguments{
\item{data}{A data frame from \code{\link[=correct_position_effect]{correct_position_effect()}} containing
\code{corrected_log2_ratio}, \code{Consequence}, \code{targeton_id}, and
\code{pam_mut_sgrna_id} columns.}

\item{neutral_variants}{Character vector of VEP consequence types to use
as the neutral reference for estimating the null SD
(default: \code{c("synonymous_variant")}).}

\item{fdr_threshold}{FDR threshold for significance classification
(default: 0.01).}
}
\value{
The input data frame with additional columns:
\describe{
\item{pos_z_score}{Z-score of corrected_log2_ratio relative to
neutral variant SD within the same targeton}
\item{pos_pval}{Two-sided p-value from the normal distribution}
\item{pos_FDR}{Benjamini-Hochberg adjusted p-value (across all
targetons)}
\item{pos_classification}{Functional classification: "depleted",
"enriched", or "unchanged"}
}
}
\description{
Performs empirical null testing on position-corrected log2 ratios by
estimating the null distribution from neutral variants within each targeton.
Z-scores are computed per targeton and FDR correction is applied globally.
}
\details{
This function provides a simple alternative to DESeq2-based testing
for position-corrected data. For each targeton:
\enumerate{
\item Computes the standard deviation of \code{corrected_log2_ratio} from
neutral variants (excluding PAM-impacted variants)
\item Computes z-scores for all variants as corrected_log2_ratio / SD
\item Computes two-sided p-values from the standard normal distribution
}
FDR correction (BH method) is then applied across all targetons combined.
}
\examples{
\dontrun{
pos_data <- calculate_position_effect(count_data, annotation, "Day4")
corrected <- correct_position_effect(pos_data)
tested <- test_position_corrected(corrected)
}

}
\seealso{
\code{\link[=correct_position_effect]{correct_position_effect()}}, \code{\link[=run_positional_differential_analysis]{run_positional_differential_analysis()}}
}
