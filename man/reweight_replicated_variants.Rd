% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential-analysis.R
\name{reweight_replicated_variants}
\alias{reweight_replicated_variants}
\title{Reweight replicated variants using inverse variance weighting}
\usage{
reweight_replicated_variants(data, fdr_threshold = 0.01)
}
\arguments{
\item{data}{A data frame with \code{HGVSc}, \code{HGVSp}, \code{pam_mut_sgrna_id},
\code{lfcSE_continuous}, and \code{adj_lfc_continuous} columns.}

\item{fdr_threshold}{FDR threshold for functional classification
(default: 0.01).}
}
\value{
Data frame with one row per unique HGVSc/HGVSp combination,
containing:
\describe{
\item{HGVSc, HGVSp}{Variant identifiers}
\item{n_total}{Total number of observations}
\item{n_pam}{Number of PAM-impacted observations}
\item{n_used}{Number of observations used (weight > 0)}
\item{pam_only}{Logical; TRUE if only PAM observations exist}
\item{combined_lfc}{Weighted average log fold change}
\item{combined_SE}{Standard error of combined estimate}
\item{combined_Z}{Z-score of combined estimate}
\item{pval}{Two-sided p-value}
\item{FDR}{Benjamini-Hochberg adjusted p-value}
\item{functional_classification}{depleted/enriched/unchanged}
}
}
\description{
Combines measurements from replicated variants (same HGVSc/HGVSp) using
inverse variance weighting. PAM-impacted observations are down-weighted
when non-PAM alternatives exist.
}
\details{
The weighting strategy prioritizes non-PAM observations:
\itemize{
\item Non-PAM observations always receive weight = 1/SE^2
\item PAM observations receive zero weight if non-PAM alternatives exist
\item PAM-only variants use normal weighting (better than nothing)
}
}
\examples{
\dontrun{
weighted_results <- reweight_replicated_variants(variant_data)
}

}
