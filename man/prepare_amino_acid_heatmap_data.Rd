% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/domains.R
\name{prepare_amino_acid_heatmap_data}
\alias{prepare_amino_acid_heatmap_data}
\title{Prepare data for amino acid heatmap visualization}
\usage{
prepare_amino_acid_heatmap_data(
  data,
  score_col = "adj_score_continuous",
  fdr_col = "FDR_continuous",
  fdr_threshold = 0.01,
  amino_acids_col = "Amino_acids",
  position_col = "Protein_position"
)
}
\arguments{
\item{data}{A data frame containing variant information.}

\item{score_col}{Character. Name of the score column (default: "adj_score_continuous").}

\item{fdr_col}{Character. Name of the FDR column (default: "FDR_continuous").}

\item{fdr_threshold}{Numeric. FDR threshold for significance (default: 0.01).}

\item{amino_acids_col}{Character. Name of the column containing amino acid
change in format "X/Y" (default: "Amino_acids").}

\item{position_col}{Character. Name of the protein position column}
}
\value{
A tibble with columns: AA_change, previous, new_aa, Protein_position,
mean_adj_score, mean_FDR, functional_classification.
}
\description{
Filters and aggregates variant data for creating an amino acid substitution
heatmap. Groups by amino acid change and computes mean scores and FDR,
then classifies variants as enriched, depleted, or unchanged.
}
\details{
The function:
\enumerate{
\item Creates AA_change identifier (e.g., "A123V")
\item Groups by unique amino acid changes and computes mean score/FDR
\item Classifies based on FDR threshold and score direction
\item Converts special characters: "*" -> "stop_scan", "-" -> "codon_deletion", "X" -> "frameshift"
\item Orders new_aa as factor using amino_acid_order
}
}
\examples{
\dontrun{
plot_data <- prepare_amino_acid_heatmap_data(variant_results)
}

}
