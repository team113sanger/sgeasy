% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/normalization.R
\name{estimate_size_factors}
\alias{estimate_size_factors}
\title{Estimate size factors from control data}
\usage{
estimate_size_factors(
  count_data,
  col_data,
  design = "~ condition",
  min_row_sum = 10,
  reference_level = NULL
)
}
\arguments{
\item{count_data}{A matrix of raw counts with genes/variants as rows and
samples as columns.}

\item{col_data}{A data frame with sample metadata. Must contain a
\code{condition} column.}

\item{design}{A formula string specifying the experimental design
(default: "~ condition").}

\item{min_row_sum}{Minimum total count across samples to retain a variant
(default: 10).}

\item{reference_level}{Reference level for condition factor (default: NULL).}
}
\value{
A named numeric vector of size factors, one per sample.
}
\description{
Estimates DESeq2 size factors using a subset of data (typically control
oligos or neutral variants) for normalization across samples.
}
\details{
This function creates a DESeqDataSet from the provided count matrix,
filters low-count variants, and estimates size factors using DESeq2's
median-of-ratios method. The size factors can then be applied to a
separate count matrix for normalization.
}
\examples{
\dontrun{
# Using synonymous variants for normalization
size_factors <- estimate_size_factors(
  count_data = norm_matrix,
  col_data = sample_info,
  reference_level = "Day4"
)
}

}
\seealso{
\code{\link[DESeq2]{estimateSizeFactors}}
}
