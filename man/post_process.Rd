% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential-analysis.R
\name{post_process}
\alias{post_process}
\title{Post-process screen results with annotation}
\usage{
post_process(data, annotation, targeton_id = NULL, fdr_threshold = 0.01)
}
\arguments{
\item{data}{A data frame with contrast results from differential analysis.
If \code{Targeton_ID} column already exists (e.g., from using \code{map_dfr} with
\code{.id = "Targeton_ID"}), this will be used for joining.}

\item{annotation}{A data frame with variant annotations. Must contain
\code{Seq} and \code{Targeton_ID} columns for joining.}

\item{targeton_id}{Optional character string identifying the targeton.
Only used if \code{Targeton_ID} column doesn't exist in data.}

\item{fdr_threshold}{FDR threshold for functional classification
(default: 0.01).}
}
\value{
Data frame with annotations, adjusted statistics, functional
classifications, and simplified consequence types.
}
\description{
Combines differential analysis results with variant annotations, applies
statistical adjustments, and simplifies consequence types.
}
\details{
This function provides a complete post-processing pipeline:
\enumerate{
\item Adds the targeton identifier to the data (if not already present)
\item Joins with the annotation file by SEQUENCE and Targeton_ID
\item Applies \code{\link[=recalculate_screen_statistics]{recalculate_screen_statistics()}} for statistical adjustment
\item Applies \code{\link[=slim_consequence]{slim_consequence()}} for consequence simplification
}

The function supports two workflows:
\itemize{
\item Single targeton: provide \code{targeton_id} parameter
\item Multiple targetons: use \code{map_dfr(..., .id = "Targeton_ID")} pattern
and \code{Targeton_ID} will already be in the data
}
}
\examples{
\dontrun{
# Single targeton workflow
processed <- post_process(
  data = contrast_summary,
  annotation = vep_annotations,
  targeton_id = "GENE1_exon2"
)

# Multiple targeton workflow (Targeton_ID already in data)
contrast_tables <- map_dfr(deseq_results, pluck, "contrast_summary",
                           .id = "Targeton_ID")
processed <- post_process(
  data = contrast_tables,
  annotation = vep_annotations
)
}

}
\seealso{
\code{\link[=recalculate_screen_statistics]{recalculate_screen_statistics()}}, \code{\link[=slim_consequence]{slim_consequence()}}
}
