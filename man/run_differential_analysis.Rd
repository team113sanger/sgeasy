% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential-analysis.R
\name{run_differential_analysis}
\alias{run_differential_analysis}
\title{Run differential abundance analysis}
\usage{
run_differential_analysis(
  count_matrix,
  normalization_matrix,
  sample_metadata,
  condition_levels = c("Day4", "Day7", "Day10", "Day15"),
  shrinkage_type = "normal",
  alpha = 0.05
)
}
\arguments{
\item{count_matrix}{Numeric matrix of variant counts with sequences as
row names and samples as columns.}

\item{normalization_matrix}{Matrix of neutral variants for size factor
estimation (e.g., synonymous/intronic variants).}

\item{sample_metadata}{Data frame with sample information. Must contain
\code{condition} and \code{supplier_name} columns.}

\item{condition_levels}{Character vector specifying condition factor levels
in order (default: c("Day4", "Day7", "Day10", "Day15")).}

\item{shrinkage_type}{Type of LFC shrinkage: "normal", "apeglm", or "ashr"
(default: "normal").}

\item{alpha}{Significance threshold for adjusted p-values (default: 0.05).}
}
\value{
A named list containing:
\describe{
\item{results}{DESeq2 results table as a tibble with SEQUENCE column}
\item{rlog}{Regularized log-transformed DESeqDataSet object}
\item{contrast_summary}{Combined summary across all contrasts including
log2 fold changes, p-values, and z-scores for each sample}
}
}
\description{
Performs DESeq2-based differential abundance analysis on SGE screen data,
using control oligos for size factor normalization.
}
\details{
This function implements the full SGE differential abundance pipeline:
\enumerate{
\item Extracts condition information from metadata for samples in matrix
\item Estimates size factors from neutral variants (synonymous/intronic)
\item Creates DESeqDataSet with proper experimental design
\item Applies control-derived size factors to all variants
\item Runs DESeq2 Wald tests for all condition contrasts
\item Computes regularized log transformation for visualization
\item Generates z-scores across samples for each variant
}

The control-based normalization strategy accounts for differences in
library size while avoiding bias from variants under selection.
}
\examples{
\dontrun{
results <- run_differential_analysis(
  count_matrix = counts,
  normalization_matrix = norm_counts,
  sample_metadata = metadata
)

# Access components
deseq_results <- results$results
rlog_data <- results$rlog
summary_table <- results$contrast_summary
}

}
\seealso{
\code{\link[=estimate_size_factors]{estimate_size_factors()}}, \code{\link[=create_normalization_matrix]{create_normalization_matrix()}}
}
