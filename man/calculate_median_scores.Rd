% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential-analysis.R
\name{calculate_median_scores}
\alias{calculate_median_scores}
\title{Calculate median scores for log2 fold changes}
\usage{
calculate_median_scores(
  data,
  neutral_variants = c("intron_variant", "synonymous_variant")
)
}
\arguments{
\item{data}{A data frame containing log2FoldChange columns and a
Consequence column for filtering neutral variants.}

\item{neutral_variants}{Character vector of consequence types to use for
median calculation (default: c("intron_variant", "synonymous_variant")).}
}
\value{
Data frame with additional median_log2FoldChange_* columns.
}
\description{
Computes the median of each log2FoldChange column from neutral variants
(synonymous and intronic) and adds new columns with the median values.
}
\details{
For proper statistical centering, the medians are calculated from
neutral variants (synonymous and intronic by default) that are expected
to have no functional effect. The function filters the data internally
to identify these variants, computes the median for each log2FoldChange
column, then broadcasts these values to all rows in the original data.
}
\examples{
\dontrun{
# Using default neutral variants (recommended)
data_with_medians <- calculate_median_scores(contrast_summary)

# Using custom neutral variant types
data_with_medians <- calculate_median_scores(
  contrast_summary,
  neutral_variants = c("synonymous_variant")
)
}

}
