% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/data-wrangling.R
\name{create_normalization_matrix}
\alias{create_normalization_matrix}
\title{Create normalization matrix from neutral variants}
\usage{
create_normalization_matrix(
  data,
  consequence_types = c("synonymous_variant", "intron_variant"),
  sample_pattern = "count"
)
}
\arguments{
\item{data}{A data frame with variant annotations including a
\code{Consequence} column and sample count columns.}

\item{consequence_types}{Character vector of consequence types to include
(default: c("synonymous_variant", "intron_variant")).}

\item{sample_pattern}{Pattern to identify sample columns
(default: "count").}
}
\value{
A numeric matrix with variants as rows and samples as columns.
Row names are set to the SEQUENCE column values.
}
\description{
Extracts synonymous and intronic variants from annotated data to create
a matrix suitable for size factor estimation.
}
\details{
This function filters the input data to retain only neutral variants
(synonymous and intronic by default) which serve as controls for
normalization. These variants are expected to have no functional effect
and thus provide a baseline for estimating library size factors.

The sample_pattern is used with \code{starts_with()} to select count columns.
When using pivot_wider with \code{names_prefix = "count_"}, columns will be
named like "count_SAMPLE_A_10_pel0000", and "count" will match these.
}
\examples{
\dontrun{
norm_matrix <- create_normalization_matrix(
  data = annotated_counts,
  consequence_types = c("synonymous_variant", "intron_variant")
)
}

}
