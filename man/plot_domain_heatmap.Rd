% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/heatmap.R
\name{plot_domain_heatmap}
\alias{plot_domain_heatmap}
\title{Plot combined domain track and amino acid heatmap}
\usage{
plot_domain_heatmap(
  data,
  uniprot_acc = NULL,
  transcript_id = NULL,
  domain_api = "ted",
  domain_df = NULL,
  plddt_df = NULL,
  merge_domains = TRUE,
  prepared = FALSE,
  height_ratio = NULL,
  domain_sources = NULL,
  consensus_levels = NULL,
  classification_colors = NULL,
  domain_colors = NULL,
  plddt_colors = NULL,
  ...
)
}
\arguments{
\item{data}{A data frame containing variant data with columns
for amino acid changes, positions, scores, and FDR values.
Will be processed by
\code{\link{prepare_amino_acid_heatmap_data}} if not already
prepared.}

\item{uniprot_acc}{Character. UniProt accession for fetching
domains (e.g., "P04637"). Also used to fetch pLDDT scores
when \code{plddt_df = "auto"}.}

\item{transcript_id}{Character. Ensembl transcript ID for
fetching domains (e.g., "ENST00000355451"). Used with
domain_api = "ensembl".}

\item{domain_api}{Character. Which API to use for fetching
domains: "ted" (default), "interpro", or "ensembl".}

\item{domain_df}{A data frame of domains. If provided, skips
API fetch.}

\item{plddt_df}{A data frame of pLDDT scores as returned by
\code{\link{fetch_plddt_alphafold}}, or the string "auto"
to fetch from AlphaFold using \code{uniprot_acc}. If NULL
(default), no pLDDT track is shown.}

\item{merge_domains}{Logical. Whether to merge overlapping
domains (default: TRUE).}

\item{prepared}{Logical. Whether \code{data} has already been
processed by
\code{\link{prepare_amino_acid_heatmap_data}}
(default: FALSE).}

\item{height_ratio}{Numeric vector. Relative heights of tracks
and heatmap. Length depends on number of tracks: 2 elements
for domain + heatmap, 3 elements for pLDDT + domain +
heatmap. If NULL, uses sensible defaults.}

\item{domain_sources}{Character vector. Filter domains to
specific sources (e.g., c("pfam", "smart") for InterPro).}

\item{consensus_levels}{Character vector. For TED API only:
filter by consensus level ("high", "medium", "low").}

\item{classification_colors}{Named character vector for
heatmap colors.}

\item{domain_colors}{Named character vector for domain colors.}

\item{plddt_colors}{Named character vector for pLDDT
confidence category colors (H, M, L, D).}

\item{...}{Additional arguments passed to
\code{\link{prepare_amino_acid_heatmap_data}}.}
}
\value{
A patchwork object combining tracks and heatmap.
}
\description{
High-level function that creates a combined visualization with
protein domains and optionally pLDDT confidence scores shown
above an amino acid substitution heatmap. Uses patchwork to
align x-axes.
}
\examples{
\dontrun{
# With domain track only
p <- plot_domain_heatmap(
  data = variant_results,
  uniprot_acc = "P04637",
  domain_api = "ted"
)

# With pLDDT track (auto-fetch from AlphaFold)
p <- plot_domain_heatmap(
  data = variant_results,
  uniprot_acc = "P04637",
  plddt_df = "auto"
)

# With pre-fetched pLDDT data
plddt <- fetch_plddt_alphafold("P04637")
p <- plot_domain_heatmap(
  data = variant_results,
  uniprot_acc = "P04637",
  plddt_df = plddt
)

# Save to file
ggplot2::ggsave(
  "domain_heatmap.png", p,
  width = 8, height = 7, dpi = 600
)
}

}
