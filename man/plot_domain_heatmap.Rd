% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/domains.R
\name{plot_domain_heatmap}
\alias{plot_domain_heatmap}
\title{Plot combined domain track and amino acid heatmap}
\usage{
plot_domain_heatmap(
  data,
  uniprot_acc = NULL,
  transcript_id = NULL,
  domain_api = "ted",
  domain_df = NULL,
  merge_domains = TRUE,
  prepared = FALSE,
  height_ratio = c(1, 15),
  domain_sources = NULL,
  consensus_levels = NULL,
  classification_colors = NULL,
  domain_colors = NULL,
  ...
)
}
\arguments{
\item{data}{A data frame containing variant data with columns for amino acid
changes, positions, scores, and FDR values. Will be processed by
\code{\link{prepare_amino_acid_heatmap_data}} if not already prepared.}

\item{uniprot_acc}{Character. UniProt accession for fetching domains
(e.g., "P04637"). Used with domain_api = "interpro" or "ted".}

\item{transcript_id}{Character. Ensembl transcript ID for fetching domains
(e.g., "ENST00000355451"). Used with domain_api = "ensembl".}

\item{domain_api}{Character. Which API to use for fetching domains:
"ted" (default, structural domains from AlphaFold),
"interpro" (sequence-based, aggregates Pfam/SMART/etc), or
"ensembl" (requires transcript_id).}

\item{domain_df}{A data frame of domains. If provided, skips API fetch.}

\item{merge_domains}{Logical. Whether to merge overlapping domains
(default: TRUE).}

\item{prepared}{Logical. Whether \code{data} has already been processed by
\code{\link{prepare_amino_acid_heatmap_data}} (default: FALSE).}

\item{height_ratio}{Numeric vector of length 2. Relative heights of domain
track and heatmap (default: c(1, 15)).}

\item{domain_sources}{Character vector. Filter domains to specific sources
(e.g., c("pfam", "smart") for InterPro).}

\item{consensus_levels}{Character vector. For TED API only: filter by
consensus level ("high", "medium", "low").}

\item{classification_colors}{Named character vector for heatmap colors.}

\item{domain_colors}{Named character vector for domain colors.}

\item{...}{Additional arguments passed to
\code{\link{prepare_amino_acid_heatmap_data}}.}
}
\value{
A patchwork object combining domain track and heatmap.
}
\description{
High-level function that creates a combined visualization with protein
domains shown above an amino acid substitution heatmap. Uses patchwork
to align x-axes.
}
\examples{
\dontrun{
# With TED (structural domains, recommended)
p <- plot_domain_heatmap(
  data = variant_results,
  uniprot_acc = "P04637",
  domain_api = "ted"
)

# With InterPro (sequence-based domains)
p <- plot_domain_heatmap(
  data = variant_results,
  uniprot_acc = "P04637",
  domain_api = "interpro"
)

# With Ensembl
p <- plot_domain_heatmap(
  data = variant_results,
  transcript_id = "ENST00000355451",
  domain_api = "ensembl"
)

# Save to file
ggplot2::ggsave("domain_heatmap.png", p, width = 8, height = 7, dpi = 600)
}

}
