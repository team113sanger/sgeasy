% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/domains.R
\name{plot_domain_heatmap}
\alias{plot_domain_heatmap}
\title{Plot combined domain track and amino acid heatmap}
\usage{
plot_domain_heatmap(
  data,
  uniprot_acc = NULL,
  transcript_id = NULL,
  domain_df = NULL,
  merge_domains = TRUE,
  prepared = FALSE,
  height_ratio = c(1, 15),
  domain_sources = NULL,
  classification_colors = NULL,
  domain_colors = NULL,
  ...
)
}
\arguments{
\item{data}{A data frame containing variant data with columns for amino acid
changes, positions, scores, and FDR values. Will be processed by
\code{\link{prepare_amino_acid_heatmap_data}} if not already prepared.}

\item{uniprot_acc}{Character. UniProt accession for fetching domains from
InterPro (e.g., "P04637"). Takes precedence over transcript_id.}

\item{transcript_id}{Character. Ensembl transcript ID for fetching domains
(e.g., "ENST00000355451"). Used only if uniprot_acc is NULL.}

\item{domain_df}{A data frame of domains (output from
\code{\link{fetch_domains_interpro}} or \code{\link{fetch_domains_ensembl}}).
If NULL, domains will be fetched using uniprot_acc or transcript_id.}

\item{merge_domains}{Logical. Whether to merge overlapping domains
(default: TRUE).}

\item{prepared}{Logical. Whether \code{data} has already been processed by
\code{\link{prepare_amino_acid_heatmap_data}} (default: FALSE).}

\item{height_ratio}{Numeric vector of length 2. Relative heights of domain
track and heatmap (default: c(1, 15)).}

\item{domain_sources}{Character vector. Filter domains to specific sources
(e.g., c("pfam", "smart") for InterPro).}

\item{classification_colors}{Named character vector for heatmap colors.}

\item{domain_colors}{Named character vector for domain colors.}

\item{...}{Additional arguments passed to
\code{\link{prepare_amino_acid_heatmap_data}}.}
}
\value{
A patchwork object combining domain track and heatmap.
}
\description{
High-level function that creates a combined visualization with protein
domains shown above an amino acid substitution heatmap. Uses patchwork
to align x-axes.
}
\examples{
\dontrun{
# With InterPro (recommended)
p <- plot_domain_heatmap(
  data = variant_results,
  uniprot_acc = "P04637"
)

# With Ensembl
p <- plot_domain_heatmap(
  data = variant_results,
  transcript_id = "ENST00000355451"
)

# With pre-fetched domains
domains <- fetch_domains_interpro("P04637")
p <- plot_domain_heatmap(
  data = variant_results,
  domain_df = domains
)

# Save to file
ggplot2::ggsave("domain_heatmap.png", p, width = 8, height = 7, dpi = 600)
}

}
