[{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"SGE Downstream Analysis Workflow","text":"vignette demonstrates complete workflow analyzing Saturation Genome Editing (SGE) screen data using sgeasy package.","code":""},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"quick-start-with-stage-wrappers","dir":"Articles","previous_headings":"Introduction","what":"Quick Start with Stage Wrappers","title":"SGE Downstream Analysis Workflow","text":"streamlined workflow, use stage wrapper functions:","code":"library(sgeasy)  # Stage 1: Load data (returns SGEData object) sge_data <- load_sge_data(   count_files = \"inputs/\",   metadata_file = \"metadata/screen_metadata.tsv\" ) sge_data #> ── SGE Data ── #> • Variants: 50,000 #> • Samples: 16 #> • Conditions: 4 #> • Annotation: loaded  # Stage 2: Prepare matrices (accepts SGEData directly) matrices <- prepare_count_matrices(   data = sge_data,   exclude_samples = c(\"bad_sample\"),   min_counts = 10 )  # Stage 3: Run analysis (can pass SGEData for metadata) results <- analyze_screens(   complete_matrices = matrices$complete_matrices,   normalisation_matrices = matrices$normalisation_matrices,   metadata = sge_data )  # Stage 4: Generate QC plots generate_qc_plots(   rlog_results = results$rlog_results,   output_dir = \"results/qc\" )  # Stage 5: Generate results final <- generate_results(   contrast_tables = results$contrast_tables,   annotation = sge_data@annotation,   output_dir = \"results\" )"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"detailed-workflow","dir":"Articles","previous_headings":"Introduction","what":"Detailed Workflow","title":"SGE Downstream Analysis Workflow","text":"following sections provide detailed explanation step. workflow includes: Reading preparing count data Joining sample metadata variant annotations Filtering removing artefacts Normalizing using control variants (synonymous/intronic) Running differential abundance analysis DESeq2 Quality control visualization (distance matrices, PCA) Post-processing statistical adjustment Gene-level analysis Reweighting replicated variants Visualization results","code":""},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"SGE Downstream Analysis Workflow","text":"Load required packages:","code":"library(sgeasy) library(fs) library(readr) library(dplyr) library(purrr) library(tidyr) library(pheatmap) library(RColorBrewer) library(ggplot2) library(glue)"},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"reading-count-files","dir":"Articles","previous_headings":"Data Import","what":"Reading Count Files","title":"SGE Downstream Analysis Workflow","text":"SGE count data typically comes multiple quantification files. Use fs::dir_ls() find count files: Read count files single dataset:","code":"input_files <- fs::dir_ls(   \"inputs/run_51287\",   type = \"any\",   recurse = TRUE,   glob = \"*lib_counts.tsv.gz\" )  # Optionally filter files (e.g., exclude certain samples) input_files <- input_files[!grepl(input_files, pattern = \"pel\")]  # Add additional runs if needed added_files <- fs::dir_ls(   \"inputs/run_47241\",   recurse = TRUE,   glob = \"*lib_counts.tsv.gz\" ) added_files <- added_files[!grepl(added_files, pattern = \"mave-qc\")]  input_files <- c(input_files, added_files) counts_dataset <- readr::read_tsv(input_files, comment = \"##\")"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"loading-metadata","dir":"Articles","previous_headings":"Data Import","what":"Loading Metadata","title":"SGE Downstream Analysis Workflow","text":"Load screen metadata containing sample information:","code":"screen_metadata <- readr::read_tsv(\"metadata/screen_metadata.tsv\")  # Calculate duration from condition (e.g., \"Day7\" -> 7 - 4 = 3) screen_metadata <- screen_metadata |>   mutate(duration = as.numeric(str_remove(condition, pattern = \"Day\")) - 4)"},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"joining-counts-with-metadata","dir":"Articles","previous_headings":"Data Preparation","what":"Joining Counts with Metadata","title":"SGE Downstream Analysis Workflow","text":"Combine count data sample metadata:","code":"complete_dataset <- counts_dataset |>   left_join(screen_metadata, by = c(\"SAMPLE\" = \"sequencing_id\"))"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"sample-exclusion","dir":"Articles","previous_headings":"Data Preparation","what":"Sample Exclusion","title":"SGE Downstream Analysis Workflow","text":"Remove problematic samples:","code":"exclude_samples <- c(\"SAMPLE_A_10_pel0000\")  # Replace with actual sample names  complete_dataset <- complete_dataset |>   dplyr::filter(!supplier_name %in% exclude_samples) |>   dplyr::filter(!SAMPLE %in% exclude_samples) |>   dplyr::filter(targeton_id != \"FRTW\")  # Exclude specific targetons if needed"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"splitting-by-targeton","dir":"Articles","previous_headings":"Data Preparation","what":"Splitting by Targeton","title":"SGE Downstream Analysis Workflow","text":"data contains multiple targetons, split separate datasets:","code":"targeton_matrices <- complete_dataset |>   group_by(targeton_id) |>   group_split()  # Name each list element by targeton_id targeton_matrices <- targeton_matrices |>   purrr::set_names(map_chr(targeton_matrices, ~ unique(.x$targeton_id)))"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"creating-count-matrices","dir":"Articles","previous_headings":"Data Preparation","what":"Creating Count Matrices","title":"SGE Downstream Analysis Workflow","text":"Pivot data wide format samples columns. Important: Use names_prefix = \"count_\" prepend prefix sample column names: Handle duplicate sequences keeping first occurrence:","code":"count_matrices <- map(   targeton_matrices,   pivot_wider,   names_from = \"supplier_name\",   values_from = \"COUNT\",   names_prefix = \"count_\",   id_cols = c(\"NAME\", \"SEQUENCE\", \"LENGTH\", \"targeton_id\") ) unique_matrices <- map(   count_matrices,   ~ group_by(.x, SEQUENCE) |>     slice_head(n = 1) |>     ungroup() )"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"filtering-by-count-threshold","dir":"Articles","previous_headings":"Data Preparation","what":"Filtering by Count Threshold","title":"SGE Downstream Analysis Workflow","text":"Use filter_by_counts() remove low-count variants:","code":"filtered_matrices <- map(   unique_matrices,   filter_by_counts,   min_counts = 10 )"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"adding-variant-annotations","dir":"Articles","previous_headings":"","what":"Adding Variant Annotations","title":"SGE Downstream Analysis Workflow","text":"Load VEP annotations join count data:","code":"# Get annotation file path from metadata annotations <- screen_metadata |>   pull(vep_anno) |>   unique()  master_annotation <- readr::read_tsv(annotations)  # Join annotations annotated_counts <- map(   filtered_matrices,   ~ left_join(     .x,     master_annotation,     by = c(\"SEQUENCE\" = \"Seq\", \"targeton_id\" = \"Targeton_ID\")   ) )"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"removing-artefacts","dir":"Articles","previous_headings":"Adding Variant Annotations","what":"Removing Artefacts","title":"SGE Downstream Analysis Workflow","text":"Remove variants lack valid sgRNA identifiers (artefacts):","code":"annotated_counts <- map(annotated_counts, remove_artefacts)"},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"creating-normalization-matrices","dir":"Articles","previous_headings":"Normalization","what":"Creating Normalization Matrices","title":"SGE Downstream Analysis Workflow","text":"Extract neutral variants (synonymous intronic) normalization: uses variants expected functional effect controls estimating library size factors.","code":"normalisation_matrices <- map(   annotated_counts,   create_normalization_matrix )"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"creating-input-matrices","dir":"Articles","previous_headings":"Normalization","what":"Creating Input Matrices","title":"SGE Downstream Analysis Workflow","text":"Create full count matrices analysis:","code":"complete_matrices <- map(   annotated_counts,   create_count_matrix )"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"differential-abundance-analysis","dir":"Articles","previous_headings":"","what":"Differential Abundance Analysis","title":"SGE Downstream Analysis Workflow","text":"Run complete differential abundance pipeline: element deseq_results SGEResults S7 object. can print result see summary: Access properties using @ operator: result@results - DESeq2 results table result@rlog - Regularized log-transformed data result@contrast_summary - Combined contrast statistics result@metadata - Analysis parameters (condition_levels, alpha, etc.) run_differential_analysis() function: Estimates size factors control variants Creates DESeq2 dataset experimental design Applies control-derived normalization Runs Wald tests condition contrasts Computes regularized log transformation Generates z-scores visualization Runs continuous analysis rate estimation","code":"deseq_results <- map2(   complete_matrices,   normalisation_matrices,   run_differential_analysis,   sample_metadata = screen_metadata ) deseq_results[[1]] #> ── SGE Analysis Results ── #> • Variants: 12,345 #> • Samples: 16 #> • Contrasts: 3 #> #> Access data with @results, @rlog, @contrast_summary"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"combining-results","dir":"Articles","previous_headings":"Differential Abundance Analysis","what":"Combining Results","title":"SGE Downstream Analysis Workflow","text":"Combine contrast tables targetons using map_dfr .id preserve targeton identity. Use @ access contrast_summary property SGEResults object:","code":"contrast_tables <- map_dfr(   deseq_results,   \\(x) x@contrast_summary,   .id = \"Targeton_ID\" )"},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"sample-distance-matrices","dir":"Articles","previous_headings":"Quality Control Visualization","what":"Sample Distance Matrices","title":"SGE Downstream Analysis Workflow","text":"Visualize sample--sample distances check outliers batch effects:","code":"# Extract rlog data from each SGEResults object rlog_results <- map(deseq_results, \\(x) x@rlog)  dist_matrices <- map(rlog_results, sample_distance_matrix) plot_distance_matrices(dist_matrices, output_dir = \"results/qc\")"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"pca-plots","dir":"Articles","previous_headings":"Quality Control Visualization","what":"PCA Plots","title":"SGE Downstream Analysis Workflow","text":"Create PCA plots visualize sample clustering:","code":"screen_pcas <- map(rlog_results, build_sample_pca) plot_screen_pcas(screen_pcas, output_dir = \"results/qc\")"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"post-processing","dir":"Articles","previous_headings":"","what":"Post-Processing","title":"SGE Downstream Analysis Workflow","text":"Apply post-processing combine results annotations, recalculate statistics, classify variants: post_process() function: Joins annotation file SEQUENCE Targeton_ID Calculates median log2FoldChange neutral variants Adjusts contrasts subtracting medians computing z-scores Classifies variants depleted/enriched/unchanged based FDR Simplifies consequence annotations","code":"recalculated_contrast_tables <- post_process(   data = contrast_tables,   annotation = master_annotation )"},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"waterfall-plots-by-targeton","dir":"Articles","previous_headings":"Visualization","what":"Waterfall Plots by Targeton","title":"SGE Downstream Analysis Workflow","text":"Generate waterfall plots targeton condition:","code":"individual_screens <- recalculated_contrast_tables |>   group_by(Targeton_ID) |>   group_split() |>   set_names(unique(recalculated_contrast_tables$Targeton_ID))  plot_sets <- imap(   individual_screens,   ~ plot_all_conditions(.x, .y) )  write_waterfall_plots(plot_sets, output_dir = \"results/screen\")"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"gene-level-analysis","dir":"Articles","previous_headings":"","what":"Gene-Level Analysis","title":"SGE Downstream Analysis Workflow","text":"multi-exon genes, combine results across targetons:","code":""},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"adding-exon-annotations","dir":"Articles","previous_headings":"Gene-Level Analysis","what":"Adding Exon Annotations","title":"SGE Downstream Analysis Workflow","text":"","code":"exon_annotations <- recalculated_contrast_tables |>   dplyr::select(Targeton_ID, EXON) |>   group_by(Targeton_ID) |>   slice_head(n = 1) |>   mutate(Exons = as.numeric(str_remove(EXON, pattern = \"/6\"))) |>   arrange(desc(Exons)) |>   dplyr::select(Targeton_ID, Exons) |>   ungroup() |>   mutate(Exons = factor(Exons, levels = c(\"6\", \"5\", \"4\", \"3\", \"2\", \"1\")))  gene_level_dataset <- recalculated_contrast_tables |>   left_join(exon_annotations, by = \"Targeton_ID\")"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"gene-level-plot","dir":"Articles","previous_headings":"Gene-Level Analysis","what":"Gene-Level Plot","title":"SGE Downstream Analysis Workflow","text":"Create gene-level functional score plot faceted exon:","code":"score_col <- \"adj_lfc_continuous\" class_col <- \"functional_classification_continuous\" fdr_col <- \"FDR_continuous\" gene_id <- \"MYGENE\"  gene_level <- ggplot(gene_level_dataset, aes(   x = vcf_pos,   y = .data[[score_col]],   shape = .data[[class_col]],   colour = slim_consequence,   fill = slim_consequence )) +   geom_point(aes(alpha = .data[[fdr_col]] <= 0.01), size = 1.5) +   scale_colour_manual(values = consequence_colours) +   scale_fill_manual(values = consequence_colours) +   scale_shape_manual(values = classification_shapes) +   scale_alpha_discrete(labels = c(\"FDR > 0.01\", \"FDR <= 0.01\")) +   xlab(\"GRCh38 coordinate\") +   ylab(\"Functional score (Adjusted LFC)\") +   ggtitle(paste(\"Functional score Plot:\", gene_id)) +   theme_classic() +   theme(     axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1,                                colour = \"black\", size = 10),     legend.title = element_blank(),     legend.position = \"right\",     legend.box = \"vertical\",     legend.margin = margin()   ) +   facet_wrap(~ Exons, scales = \"free_x\", nrow = 1)  ggsave(\"results/gene_level_plot.png\", gene_level,        width = 25, height = 6, units = \"in\", dpi = 300)"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"reweighting-replicated-variants","dir":"Articles","previous_headings":"","what":"Reweighting Replicated Variants","title":"SGE Downstream Analysis Workflow","text":"variants may represented multiple oligos. Use inverse variance weighting combine measurements:","code":""},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"preparing-results-for-reweighting","dir":"Articles","previous_headings":"Reweighting Replicated Variants","what":"Preparing Results for Reweighting","title":"SGE Downstream Analysis Workflow","text":"","code":"results <- gene_level_dataset |>   select(Targeton_ID, SEQUENCE, HGVSc, HGVSp, pam_mut_sgrna_id,          contains(\"continuous\"))"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"finding-replicated-variants","dir":"Articles","previous_headings":"Reweighting Replicated Variants","what":"Finding Replicated Variants","title":"SGE Downstream Analysis Workflow","text":"","code":"replicated_variants <- get_replicated_variants(results) replicated_variants"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"applying-inverse-variance-weighting","dir":"Articles","previous_headings":"Reweighting Replicated Variants","what":"Applying Inverse Variance Weighting","title":"SGE Downstream Analysis Workflow","text":"reweighting strategy: Non-PAM observations receive weight = 1/SE^2 PAM-impacted observations receive zero weight non-PAM alternatives exist PAM-variants use normal weighting (better nothing)","code":"reweighted_variants <- reweight_replicated_variants(results)"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"comparing-classifications","dir":"Articles","previous_headings":"Reweighting Replicated Variants","what":"Comparing Classifications","title":"SGE Downstream Analysis Workflow","text":"Check reweighting affects classifications:","code":"reweighted_variants |>   select(HGVSc, HGVSp, functional_classification) |>   left_join(results, by = c(\"HGVSc\", \"HGVSp\")) |>   select(HGVSc, HGVSp, functional_classification,          functional_classification_continuous) |>   filter(functional_classification != functional_classification_continuous)"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"weighted-score-plot","dir":"Articles","previous_headings":"Reweighting Replicated Variants","what":"Weighted Score Plot","title":"SGE Downstream Analysis Workflow","text":"","code":"combined_dataset <- reweighted_variants |>   left_join(gene_level_dataset, by = c(\"HGVSc\", \"HGVSp\"))  weighted_scores <- ggplot(combined_dataset, aes(   x = vcf_pos,   y = combined_lfc,   shape = functional_classification,   colour = slim_consequence,   fill = slim_consequence )) +   geom_point(aes(alpha = FDR <= 0.01), size = 1.5) +   scale_colour_manual(values = consequence_colours) +   scale_fill_manual(values = consequence_colours) +   scale_shape_manual(values = classification_shapes) +   scale_alpha_discrete(labels = c(\"FDR > 0.01\", \"FDR <= 0.01\")) +   xlab(\"GRCh38 coordinate\") +   ylab(\"Functional score (Weighted LFC)\") +   ggtitle(paste(\"Functional score Plot:\", gene_id, \"- Weighted LFC\")) +   theme_classic() +   theme(     axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1,                                colour = \"black\", size = 10),     legend.title = element_blank(),     legend.position = \"right\",     legend.box = \"vertical\",     legend.margin = margin()   ) +   facet_wrap(~ Exons, scales = \"free_x\", nrow = 1)  ggsave(\"results/gene_level_plot_reweight.png\", weighted_scores,        width = 25, height = 6, units = \"in\", dpi = 300)"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"protein-domain-visualization","dir":"Articles","previous_headings":"","what":"Protein Domain Visualization","title":"SGE Downstream Analysis Workflow","text":"sgeasy package includes functions creating amino acid substitution heatmaps protein domain annotations. visualization shows functional effects across protein sequence. ### Fetching Protein Domains Fetch domain annotations Ensembl transcript:","code":"# Fetch domains for your transcript transcript_id <- \"ENST00000355451\"  # Replace with your transcript domains <- fetch_domains_ensembl(transcript_id)  # Merge overlapping domain ranges merged_domains <- merge_overlapping_domains(domains) merged_domains"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"preparing-protein-altering-variant-data","dir":"Articles","previous_headings":"Protein Domain Visualization","what":"Preparing Protein altering Variant Data","title":"SGE Downstream Analysis Workflow","text":"Filter dataset Protein altering variants prepare heatmap visualization:","code":"# Filter to protein altering variants protein_altering_df <- filter_protein_altering_variants(   combined_dataset,   exclude_mutators = \"custom\",   exclude_consequences = \"synonymous\" )  # Prepare data for heatmap (aggregates by amino acid position) plot_df <- prepare_amino_acid_heatmap_data(   protein_altering_df,   score_col = \"adj_score_continuous\",   fdr_col = \"FDR_continuous\",   fdr_threshold = 0.01 )  head(plot_df)"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"creating-the-combined-visualization","dir":"Articles","previous_headings":"Protein Domain Visualization","what":"Creating the Combined Visualization","title":"SGE Downstream Analysis Workflow","text":"Create combined plot domain track amino acid heatmap:","code":"# Option 1: All-in-one with automatic domain fetching p <- plot_domain_heatmap(   data = protein_altering_df,   transcript_id = \"ENST00000355451\",   height_ratio = c(1, 15) )  # Option 2: With pre-fetched domains p <- plot_domain_heatmap(   data = protein_altering_df,   domain_df = merged_domains,   height_ratio = c(1, 15) )  # Save the plot ggsave(\"results/amino_acid_domain_heatmap.png\", p,        width = 8, height = 7, units = \"in\", dpi = 300)"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"creating-individual-plot-components","dir":"Articles","previous_headings":"Protein Domain Visualization","what":"Creating Individual Plot Components","title":"SGE Downstream Analysis Workflow","text":"control, create domain track heatmap separately:","code":"# Get shared x-axis range x_range <- range(plot_df$Protein_position)  # Create domain track domain_track <- plot_domain_track(   merged_domains,   x_range = x_range,   show_legend = TRUE )  # Create amino acid heatmap amino_acid_plot <- plot_amino_acid_heatmap(   plot_df,   x_range = x_range,   show_x_axis = TRUE )  # Combine with patchwork library(patchwork) combined_plot <- domain_track / amino_acid_plot +   plot_layout(heights = c(1, 15), axes = \"collect_x\")  # Save ggsave(\"results/custom_domain_heatmap.png\", combined_plot,        width = 8, height = 6, units = \"in\", dpi = 300)"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"customizing-colors","dir":"Articles","previous_headings":"Protein Domain Visualization","what":"Customizing Colors","title":"SGE Downstream Analysis Workflow","text":"can customize classification colors:","code":"# Custom classification colors my_colors <- c(   \"unchanged\" = \"grey80\",   \"enriched\"  = \"firebrick\",   \"depleted\"  = \"steelblue\" )  p <- plot_domain_heatmap(   data = protein_altering_df,   domain_df = merged_domains,   classification_colors = my_colors )"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"filtering-domains-by-source","dir":"Articles","previous_headings":"Protein Domain Visualization","what":"Filtering Domains by Source","title":"SGE Downstream Analysis Workflow","text":"Optionally filter specific domain sources:","code":"# Fetch only Pfam and SMART domains domains <- fetch_domains_ensembl(   \"ENST00000355451\",   domain_sources = c(\"Pfam\", \"SMART\") )"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"exporting-results","dir":"Articles","previous_headings":"","what":"Exporting Results","title":"SGE Downstream Analysis Workflow","text":"Save final results:","code":"# Gene-level weighted scores combined_dataset |>   select(HGVSc, HGVSp, combined_lfc, functional_classification, FDR) |>   left_join(results, by = c(\"HGVSc\", \"HGVSp\")) |>   write_tsv(\"results/gene_level_weighted_scores.tsv\")"},{"path":"https://github.com/team113sanger/sgeasy/articles/sge-analysis-workflow.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"SGE Downstream Analysis Workflow","text":"","code":"sessionInfo()"},{"path":"https://github.com/team113sanger/sgeasy/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jamie Billington. Author, maintainer. Andrew Waters. Author.","code":""},{"path":"https://github.com/team113sanger/sgeasy/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Billington J, Waters (2026). sgeasy: Downstream Analysis Saturation Genome Editing Screens. R package version 0.1.0, https://github.com/team113sanger/sgeasy.","code":"@Manual{,   title = {sgeasy: Downstream Analysis for Saturation Genome Editing Screens},   author = {Jamie Billington and Andrew Waters},   year = {2026},   note = {R package version 0.1.0},   url = {https://github.com/team113sanger/sgeasy}, }"},{"path":"https://github.com/team113sanger/sgeasy/index.html","id":"sgeasy","dir":"","previous_headings":"","what":"Downstream Analysis for Saturation Genome Editing Screens","title":"Downstream Analysis for Saturation Genome Editing Screens","text":"Downstream analysis tools Saturation Genome Editing (SGE) screens. package developed David Adams’ lab WTSI contains functions integrating SGE data across screens gene-level methods.","code":""},{"path":"https://github.com/team113sanger/sgeasy/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Downstream Analysis for Saturation Genome Editing Screens","text":"","code":"remotes::install_github(\"t113sanger/sgeasy\")  # Or install locally devtools::install()"},{"path":"https://github.com/team113sanger/sgeasy/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Downstream Analysis for Saturation Genome Editing Screens","text":"sgedown provides workflow analyzing SGE screen data: Normalization: Size factor estimation using control oligos (synonymous/intronic variants) Differential Analysis: DESeq2-based differential abundance across time points Meta-analysis: Combining variant scores across screens Visualization: Quality control plots sample comparisons","code":""},{"path":"https://github.com/team113sanger/sgeasy/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick Start","title":"Downstream Analysis for Saturation Genome Editing Screens","text":"","code":"library(sgeasy)  # Create normalization matrix from neutral variants norm_matrix <- create_normalization_matrix(annotated_data)  # Create count matrix for all variants count_matrix <- create_count_matrix(annotated_data)  # Run differential abundance analysis results <- run_differential_analysis(   count_matrix = count_matrix,   normalization_matrix = norm_matrix,   sample_metadata = metadata )  # Access results deseq_results <- results$results rlog_data <- results$rlog summary_table <- results$contrast_summary"},{"path":"https://github.com/team113sanger/sgeasy/index.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Downstream Analysis for Saturation Genome Editing Screens","text":"See package vignette complete workflow tutorial:","code":"vignette(\"sge-analysis-workflow\", package = \"sgedown\")"},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEData.html","id":null,"dir":"Reference","previous_headings":"","what":"SGEData Class — SGEData","title":"SGEData Class — SGEData","text":"S7 class holds loaded SGE screen data analysis.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEData.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SGEData Class — SGEData","text":"","code":"SGEData(   counts = (function (.data = list(), row.names = NULL)   {      if (is.null(row.names))     {          list2DF(.data)      }      else {          out <- list2DF(.data,     length(row.names)) attr(out, \"row.names\") <- row.names          out      }      })(),   metadata = (function (.data = list(), row.names = NULL)   {      if     (is.null(row.names)) {          list2DF(.data)      }      else {          out <-     list2DF(.data, length(row.names)) attr(out, \"row.names\") <- row.names              out      }  })(),   annotation = NULL,   complete_dataset = (function (.data = list(), row.names = NULL)   {      if     (is.null(row.names)) {          list2DF(.data)      }      else {          out <-     list2DF(.data, length(row.names)) attr(out, \"row.names\") <- row.names              out      }  })() )"},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEData.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SGEData Class — SGEData","text":"counts data frame raw count data SEQUENCE SAMPLE columns. metadata data frame sample metadata condition information. annotation data frame variant annotations (optional, can NULL). complete_dataset data frame counts joined metadata.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEData.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SGEData Class — SGEData","text":"S7 object class SGEData.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEData.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"SGEData Class — SGEData","text":"Access properties using @ operator: data@counts - Raw count data data@metadata - Sample metadata data@annotation - Variant annotations (may NULL) data@complete_dataset - Counts joined metadata","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEData.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SGEData Class — SGEData","text":"","code":"if (FALSE) { # \\dontrun{ # Load data (returns SGEData object) data <- load_sge_data(   count_files = \"inputs/\",   metadata_file = \"metadata/screen_metadata.tsv\" )  # Print shows summary data  # Access properties data@counts data@metadata data@annotation data@complete_dataset } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEResults.html","id":null,"dir":"Reference","previous_headings":"","what":"SGEResults Class — SGEResults","title":"SGEResults Class — SGEResults","text":"S7 class holds results SGE differential abundance analysis.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEResults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"SGEResults Class — SGEResults","text":"","code":"SGEResults(   results = (function (.data = list(), row.names = NULL)   {      if (is.null(row.names))     {          list2DF(.data)      }      else {          out <- list2DF(.data,     length(row.names)) attr(out, \"row.names\") <- row.names          out      }      })(),   rlog = NULL,   contrast_summary = (function (.data = list(), row.names = NULL)   {      if     (is.null(row.names)) {          list2DF(.data)      }      else {          out <-     list2DF(.data, length(row.names)) attr(out, \"row.names\") <- row.names              out      }  })(),   metadata = list() )"},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEResults.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"SGEResults Class — SGEResults","text":"results data frame (tibble) containing DESeq2 results SEQUENCE column identifying variant. rlog DESeqTransform object containing regularized log-transformed counts visualization. contrast_summary data frame (tibble) containing combined summary statistics across contrasts, including log2 fold changes, p-values, z-scores, optional rate estimates. metadata list analysis metadata including condition levels, shrinkage type, alpha threshold, analysis timestamp.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEResults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"SGEResults Class — SGEResults","text":"S7 object class SGEResults.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEResults.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"SGEResults Class — SGEResults","text":"Access properties using @ operator: results@results - DESeq2 results table results@rlog - Regularized log-transformed data results@contrast_summary - Combined contrast statistics results@metadata - Analysis parameters timestamp","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/SGEResults.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"SGEResults Class — SGEResults","text":"","code":"if (FALSE) { # \\dontrun{ # Run analysis (returns SGEResults object) results <- run_differential_analysis(counts, norm_counts, metadata)  # Print shows summary results  # Access properties results@results results@contrast_summary results@rlog  # Get rlog matrix SummarizedExperiment::assay(results@rlog)  # Check analysis metadata results@metadata$analysis_date } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/add_aa_change.html","id":null,"dir":"Reference","previous_headings":"","what":"Add AA_change column and convert protein position to numeric — add_aa_change","title":"Add AA_change column and convert protein position to numeric — add_aa_change","text":"Internal helper function creates AA_change identifier (e.g., \"A123V\") amino acid position columns, converts position numeric, filters rows invalid positions.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/add_aa_change.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add AA_change column and convert protein position to numeric — add_aa_change","text":"","code":"add_aa_change(data, amino_acids_col, position_col)"},{"path":"https://github.com/team113sanger/sgeasy/reference/add_aa_change.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add AA_change column and convert protein position to numeric — add_aa_change","text":"data data frame containing variant information. amino_acids_col Character. Name amino acids column. position_col Character. Name protein position column.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/add_aa_change.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add AA_change column and convert protein position to numeric — add_aa_change","text":"data frame AA_change column added, Protein_position numeric, rows NA positions removed.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/add_adj_columns.html","id":null,"dir":"Reference","previous_headings":"","what":"Add adjusted statistics for a single contrast — add_adj_columns","title":"Add adjusted statistics for a single contrast — add_adj_columns","text":"Computes adjusted log fold change, z-score, p-value FDR specified contrast suffix.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/add_adj_columns.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add adjusted statistics for a single contrast — add_adj_columns","text":"","code":"add_adj_columns(data, suffix)"},{"path":"https://github.com/team113sanger/sgeasy/reference/add_adj_columns.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add adjusted statistics for a single contrast — add_adj_columns","text":"data data frame log2FoldChange, lfcSE, median columns. suffix contrast suffix (e.g., \"condition_Day7_vs_Day4\").","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/add_adj_columns.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add adjusted statistics for a single contrast — add_adj_columns","text":"Data frame additional adj_lfc_, adj_score_, pval_, FDR_ columns specified suffix.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/add_adj_columns.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Add adjusted statistics for a single contrast — add_adj_columns","text":"adjusted log fold change subtracts median LFC (neutral variants) center distribution. adjusted score computed adj_lfc / lfcSE, follows approximately standard normal distribution null hypothesis. P-values computed two-sided normal test.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/add_classification.html","id":null,"dir":"Reference","previous_headings":"","what":"Add functional classification for a single contrast — add_classification","title":"Add functional classification for a single contrast — add_classification","text":"Classifies variants depleted, enriched, unchanged based FDR threshold log fold change direction.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/add_classification.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add functional classification for a single contrast — add_classification","text":"","code":"add_classification(data, suffix, fdr_threshold = 0.01)"},{"path":"https://github.com/team113sanger/sgeasy/reference/add_classification.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add functional classification for a single contrast — add_classification","text":"data data frame FDR adj_lfc columns. suffix contrast suffix. fdr_threshold FDR threshold significance (default: 0.01).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/add_classification.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add functional classification for a single contrast — add_classification","text":"Data frame additional functional_classification_* column.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/adjust_all_contrasts.html","id":null,"dir":"Reference","previous_headings":"","what":"Adjust statistics for all contrasts — adjust_all_contrasts","title":"Adjust statistics for all contrasts — adjust_all_contrasts","text":"Applies add_adj_columns() contrasts found data.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/adjust_all_contrasts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adjust statistics for all contrasts — adjust_all_contrasts","text":"","code":"adjust_all_contrasts(data)"},{"path":"https://github.com/team113sanger/sgeasy/reference/adjust_all_contrasts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adjust statistics for all contrasts — adjust_all_contrasts","text":"data data frame log2FoldChange columns multiple contrasts.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/adjust_all_contrasts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adjust statistics for all contrasts — adjust_all_contrasts","text":"Data frame adjusted statistics contrasts.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/adjust_all_contrasts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Adjust statistics for all contrasts — adjust_all_contrasts","text":"","code":"if (FALSE) { # \\dontrun{ adjusted_data <- adjust_all_contrasts(contrast_summary) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/amino_acid_order.html","id":null,"dir":"Reference","previous_headings":"","what":"Standard amino acid ordering for heatmap y-axis — amino_acid_order","title":"Standard amino acid ordering for heatmap y-axis — amino_acid_order","text":"character vector defining order amino acids special variant types heatmap y-axis.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/amino_acid_order.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Standard amino acid ordering for heatmap y-axis — amino_acid_order","text":"","code":"amino_acid_order"},{"path":"https://github.com/team113sanger/sgeasy/reference/amino_acid_order.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Standard amino acid ordering for heatmap y-axis — amino_acid_order","text":"object class character length 23.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/analyze_screens.html","id":null,"dir":"Reference","previous_headings":"","what":"Run differential analysis on all screens — analyze_screens","title":"Run differential analysis on all screens — analyze_screens","text":"Runs DESeq2-based differential analysis targetons prepared count matrices.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/analyze_screens.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run differential analysis on all screens — analyze_screens","text":"","code":"analyze_screens(   complete_matrices,   normalisation_matrices,   metadata,   condition_levels = c(\"Day4\", \"Day7\", \"Day10\", \"Day15\"),   ... )"},{"path":"https://github.com/team113sanger/sgeasy/reference/analyze_screens.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run differential analysis on all screens — analyze_screens","text":"complete_matrices List count matrices prepare_count_matrices(). normalisation_matrices List normalization matrices prepare_count_matrices(). metadata Sample metadata data frame, SGEData object metadata extracted. condition_levels Character vector condition factor levels (default: c(\"Day4\", \"Day7\", \"Day10\", \"Day15\")). ... Additional arguments passed run_differential_analysis().","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/analyze_screens.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run differential analysis on all screens — analyze_screens","text":"list containing: deseq_results List SGEResults objects targeton contrast_tables Combined contrast table targetons rlog_results List rlog-transformed data targeton","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/analyze_screens.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run differential analysis on all screens — analyze_screens","text":"","code":"if (FALSE) { # \\dontrun{ # Using SGEData object results <- analyze_screens(   complete_matrices = matrices$complete_matrices,   normalisation_matrices = matrices$normalisation_matrices,   metadata = sge_data )  # Using metadata data frame directly results <- analyze_screens(   complete_matrices = matrices$complete_matrices,   normalisation_matrices = matrices$normalisation_matrices,   metadata = metadata_df ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/build_sample_pca.html","id":null,"dir":"Reference","previous_headings":"","what":"Build PCA plot from rlog data — build_sample_pca","title":"Build PCA plot from rlog data — build_sample_pca","text":"Creates PCA plot regularized log-transformed data, colored condition shaped replicate.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/build_sample_pca.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build PCA plot from rlog data — build_sample_pca","text":"","code":"build_sample_pca(   rlog_data,   intgroup = c(\"condition\", \"replicate\"),   point_size = 3 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/build_sample_pca.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build PCA plot from rlog data — build_sample_pca","text":"rlog_data DESeqTransform object (output DESeq2::rlog()). intgroup Character vector variables use grouping (default: c(\"condition\", \"replicate\")). point_size Size points plot (default: 3).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/build_sample_pca.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build PCA plot from rlog data — build_sample_pca","text":"ggplot object.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/build_sample_pca.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build PCA plot from rlog data — build_sample_pca","text":"","code":"if (FALSE) { # \\dontrun{ pca_plot <- build_sample_pca(results$rlog) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_median_scores.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate median scores for log2 fold changes — calculate_median_scores","title":"Calculate median scores for log2 fold changes — calculate_median_scores","text":"Computes median log2FoldChange column neutral variants (synonymous intronic) adds new columns median values.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_median_scores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate median scores for log2 fold changes — calculate_median_scores","text":"","code":"calculate_median_scores(   data,   neutral_variants = c(\"intron_variant\", \"synonymous_variant\") )"},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_median_scores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate median scores for log2 fold changes — calculate_median_scores","text":"data data frame containing log2FoldChange columns Consequence column filtering neutral variants. neutral_variants Character vector consequence types use median calculation (default: c(\"intron_variant\", \"synonymous_variant\")).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_median_scores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate median scores for log2 fold changes — calculate_median_scores","text":"Data frame additional median_log2FoldChange_* columns.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_median_scores.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate median scores for log2 fold changes — calculate_median_scores","text":"proper statistical centering, medians calculated neutral variants (synonymous intronic default) expected functional effect. function filters data internally identify variants, computes median log2FoldChange column, broadcasts values rows original data.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_median_scores.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate median scores for log2 fold changes — calculate_median_scores","text":"","code":"if (FALSE) { # \\dontrun{ # Using default neutral variants (recommended) data_with_medians <- calculate_median_scores(contrast_summary)  # Using custom neutral variant types data_with_medians <- calculate_median_scores(   contrast_summary,   neutral_variants = c(\"synonymous_variant\") ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_position_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate position effect ratios — calculate_position_effect","title":"Calculate position effect ratios — calculate_position_effect","text":"Calculates ratio counts specified timepoint Day0 sequence, grouped NAME condition.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_position_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate position effect ratios — calculate_position_effect","text":"","code":"calculate_position_effect(dataframe, annotation, timepoint)"},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_position_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate position effect ratios — calculate_position_effect","text":"dataframe data frame COUNT, condition, NAME, SEQUENCE columns. annotation data frame sequence annotations containing Seq column. timepoint Character string specifying timepoint compare Day0 (e.g., \"Day10\", \"Day14\").","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_position_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate position effect ratios — calculate_position_effect","text":"data frame mean counts per condition, ratio calculations, joined annotation data.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/calculate_position_effect.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate position effect ratios — calculate_position_effect","text":"","code":"if (FALSE) { # \\dontrun{ pos_effect <- calculate_position_effect(   dataframe = count_data,   annotation = annotation_df,   timepoint = \"Day10\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/classification_heatmap_colours.html","id":null,"dir":"Reference","previous_headings":"","what":"Classification colours for amino acid heatmap — classification_heatmap_colours","title":"Classification colours for amino acid heatmap — classification_heatmap_colours","text":"named character vector colours functional classification categories.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/classification_heatmap_colours.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classification colours for amino acid heatmap — classification_heatmap_colours","text":"","code":"classification_heatmap_colours"},{"path":"https://github.com/team113sanger/sgeasy/reference/classification_heatmap_colours.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Classification colours for amino acid heatmap — classification_heatmap_colours","text":"object class character length 3.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/classification_shapes.html","id":null,"dir":"Reference","previous_headings":"","what":"Default shape palette for functional classifications — classification_shapes","title":"Default shape palette for functional classifications — classification_shapes","text":"named numeric vector mapping functional classifications point shapes.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/classification_shapes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default shape palette for functional classifications — classification_shapes","text":"","code":"classification_shapes"},{"path":"https://github.com/team113sanger/sgeasy/reference/classification_shapes.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Default shape palette for functional classifications — classification_shapes","text":"named numeric vector.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/classification_shapes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default shape palette for functional classifications — classification_shapes","text":"","code":"classification_shapes #> unchanged  depleted  enriched  #>         0         6         3"},{"path":"https://github.com/team113sanger/sgeasy/reference/classify_all_contrasts.html","id":null,"dir":"Reference","previous_headings":"","what":"Classify variants for all contrasts — classify_all_contrasts","title":"Classify variants for all contrasts — classify_all_contrasts","text":"Applies add_classification() contrasts found data.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/classify_all_contrasts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classify variants for all contrasts — classify_all_contrasts","text":"","code":"classify_all_contrasts(data, fdr_threshold = 0.01)"},{"path":"https://github.com/team113sanger/sgeasy/reference/classify_all_contrasts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classify variants for all contrasts — classify_all_contrasts","text":"data data frame FDR columns multiple contrasts. fdr_threshold FDR threshold significance (default: 0.01).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/classify_all_contrasts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classify variants for all contrasts — classify_all_contrasts","text":"Data frame functional classification columns contrasts.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/classify_all_contrasts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classify variants for all contrasts — classify_all_contrasts","text":"","code":"if (FALSE) { # \\dontrun{ classified_data <- classify_all_contrasts(adjusted_data, fdr_threshold = 0.01) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/classify_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Classify variants by consequence type — classify_variants","title":"Classify variants by consequence type — classify_variants","text":"Adds simplified variant_class column based Consequence annotation.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/classify_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Classify variants by consequence type — classify_variants","text":"","code":"classify_variants(data)"},{"path":"https://github.com/team113sanger/sgeasy/reference/classify_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Classify variants by consequence type — classify_variants","text":"data data frame Consequence column.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/classify_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Classify variants by consequence type — classify_variants","text":"Data frame additional variant_class column.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/classify_variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Classify variants by consequence type — classify_variants","text":"","code":"if (FALSE) { # \\dontrun{ classified_data <- classify_variants(annotated_data) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/compute_control_size_factors.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute size factors from control oligos — compute_control_size_factors","title":"Compute size factors from control oligos — compute_control_size_factors","text":"convenience wrapper around estimate_size_factors() sensible defaults SGE control oligo normalization.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/compute_control_size_factors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute size factors from control oligos — compute_control_size_factors","text":"","code":"compute_control_size_factors(   count_matrix,   sample_metadata,   reference_level = \"Day4\" )"},{"path":"https://github.com/team113sanger/sgeasy/reference/compute_control_size_factors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute size factors from control oligos — compute_control_size_factors","text":"count_matrix matrix control oligo counts. sample_metadata data frame sample information. Must contain condition column matching sample columns. reference_level Reference condition level (default: \"Day4\").","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/compute_control_size_factors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute size factors from control oligos — compute_control_size_factors","text":"named numeric vector size factors.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/compute_control_size_factors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute size factors from control oligos — compute_control_size_factors","text":"","code":"if (FALSE) { # \\dontrun{ size_factors <- compute_control_size_factors(   count_matrix = norm_matrix,   sample_metadata = metadata,   reference_level = \"Day4\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/consequence_colours.html","id":null,"dir":"Reference","previous_headings":"","what":"Default color palette for consequence types — consequence_colours","title":"Default color palette for consequence types — consequence_colours","text":"named character vector mapping slim_consequence categories colors.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/consequence_colours.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default color palette for consequence types — consequence_colours","text":"","code":"consequence_colours"},{"path":"https://github.com/team113sanger/sgeasy/reference/consequence_colours.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Default color palette for consequence types — consequence_colours","text":"named character vector.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/consequence_colours.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default color palette for consequence types — consequence_colours","text":"","code":"consequence_colours #>        synonymous       stop_gained         stop_lost        start_lost  #>      \"steelblue3\"      \"firebrick2\"         \"purple3\"         \"darkred\"  #>          missense    codon_deletion        frameshift            intron  #>        \"seagreen\"         \"orchid4\"           \"gold1\" \"lightsteelblue4\"  #>      splice_donor   splice_acceptor               UTR  #>        \"hotpink2\"     \"darkorange1\"      \"royalblue4\""},{"path":"https://github.com/team113sanger/sgeasy/reference/create_count_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Create count matrix from annotated data — create_count_matrix","title":"Create count matrix from annotated data — create_count_matrix","text":"Extracts sequence identifiers sample counts numeric matrix suitable differential analysis. Optionally filters consequence type.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/create_count_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create count matrix from annotated data — create_count_matrix","text":"","code":"create_count_matrix(data, sample_pattern = \"count\", consequence_types = NULL)"},{"path":"https://github.com/team113sanger/sgeasy/reference/create_count_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create count matrix from annotated data — create_count_matrix","text":"data data frame SEQUENCE column sample count columns. sample_pattern Pattern identify sample columns (default: \"count\"). consequence_types Optional character vector consequence types filter (requires Consequence column data). NULL (default), filtering applied.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/create_count_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create count matrix from annotated data — create_count_matrix","text":"numeric matrix sequences row names samples columns.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/create_count_matrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create count matrix from annotated data — create_count_matrix","text":"sample_pattern used starts_with() select count columns. using pivot_wider names_prefix = \"count_\", columns named like \"count_SAMPLE_A_10_pel0000\", \"count\" match .","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/create_count_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create count matrix from annotated data — create_count_matrix","text":"","code":"if (FALSE) { # \\dontrun{ count_matrix <- create_count_matrix(annotated_data)  # Filter to specific consequence types norm_matrix <- create_count_matrix(   annotated_data,   consequence_types = c(\"synonymous_variant\", \"intron_variant\") ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/create_normalization_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Create normalization matrix from neutral variants — create_normalization_matrix","title":"Create normalization matrix from neutral variants — create_normalization_matrix","text":"Extracts synonymous intronic variants annotated data create matrix suitable size factor estimation.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/create_normalization_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create normalization matrix from neutral variants — create_normalization_matrix","text":"","code":"create_normalization_matrix(   data,   consequence_types = c(\"synonymous_variant\", \"intron_variant\"),   sample_pattern = \"count\" )"},{"path":"https://github.com/team113sanger/sgeasy/reference/create_normalization_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create normalization matrix from neutral variants — create_normalization_matrix","text":"data data frame variant annotations including Consequence column sample count columns. consequence_types Character vector consequence types include (default: c(\"synonymous_variant\", \"intron_variant\")). sample_pattern Pattern identify sample columns (default: \"count\").","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/create_normalization_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create normalization matrix from neutral variants — create_normalization_matrix","text":"numeric matrix variants rows samples columns. Row names set SEQUENCE column values.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/create_normalization_matrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create normalization matrix from neutral variants — create_normalization_matrix","text":"function filters input data retain neutral variants (synonymous intronic default) serve controls normalization. variants expected functional effect thus provide baseline estimating library size factors. sample_pattern used starts_with() select count columns. using pivot_wider names_prefix = \"count_\", columns named like \"count_SAMPLE_A_10_pel0000\", \"count\" match .","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/create_normalization_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create normalization matrix from neutral variants — create_normalization_matrix","text":"","code":"if (FALSE) { # \\dontrun{ norm_matrix <- create_normalization_matrix(   data = annotated_counts,   consequence_types = c(\"synonymous_variant\", \"intron_variant\") ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/default_consequences.html","id":null,"dir":"Reference","previous_headings":"","what":"Default consequence categories for distribution plots — default_consequences","title":"Default consequence categories for distribution plots — default_consequences","text":"character vector VEP slim consequence types shown default ridgeline jitter plots. order determines display order.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/default_consequences.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default consequence categories for distribution plots — default_consequences","text":"","code":"default_consequences"},{"path":"https://github.com/team113sanger/sgeasy/reference/default_consequences.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Default consequence categories for distribution plots — default_consequences","text":"object class character length 11.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-create_deg_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Create DEG summary table for a single contrast — .create_deg_table","title":"Create DEG summary table for a single contrast — .create_deg_table","text":"Internal function extract differential expression results one contrast format suffixed column names.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-create_deg_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create DEG summary table for a single contrast — .create_deg_table","text":"","code":".create_deg_table(table, name)"},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-create_deg_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create DEG summary table for a single contrast — .create_deg_table","text":"table DEGComps result object. name Contrast name use column suffix.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-create_deg_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create DEG summary table for a single contrast — .create_deg_table","text":"tibble contrast-specific column names.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-ggpairs_scatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Custom ggpairs scatter panel function — .ggpairs_scatter","title":"Custom ggpairs scatter panel function — .ggpairs_scatter","text":"Internal function providing customized scatter plot panels ggpairs.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-ggpairs_scatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Custom ggpairs scatter panel function — .ggpairs_scatter","text":"","code":".ggpairs_scatter(data, mapping, pts = list(), smt = list(), ...)"},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-ggpairs_scatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Custom ggpairs scatter panel function — .ggpairs_scatter","text":"data Data passed ggpairs. mapping Aesthetic mapping passed ggpairs. pts List arguments ggplot2::geom_point(). smt List arguments ggplot2::geom_smooth(). ... Additional arguments (ignored).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-ggpairs_scatter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Custom ggpairs scatter panel function — .ggpairs_scatter","text":"ggplot object scatter panel.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-save_plots_to_dir.html","id":null,"dir":"Reference","previous_headings":"","what":"Save a list of plots to PNG files in a directory — .save_plots_to_dir","title":"Save a list of plots to PNG files in a directory — .save_plots_to_dir","text":"Internal helper creates output directory (needed) iterates named list, writing element PNG.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-save_plots_to_dir.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save a list of plots to PNG files in a directory — .save_plots_to_dir","text":"","code":".save_plots_to_dir(plot_list, output_dir, suffix, width, height, plot_fn)"},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-save_plots_to_dir.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save a list of plots to PNG files in a directory — .save_plots_to_dir","text":"plot_list named list plot objects. output_dir Directory write files . suffix Character string appended name .png extension. width Plot width pixels. height Plot height pixels. plot_fn function renders single element plot_list current graphics device.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-save_plots_to_dir.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save a list of plots to PNG files in a directory — .save_plots_to_dir","text":"invisible(NULL).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-sge_scatter_scales.html","id":null,"dir":"Reference","previous_headings":"","what":"Shared scale and theme layers for SGE scatter plots — .sge_scatter_scales","title":"Shared scale and theme layers for SGE scatter plots — .sge_scatter_scales","text":"Internal helper returns list ggplot2 layers shared plot_condition_scores plot_gene_level_waterfall.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-sge_scatter_scales.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shared scale and theme layers for SGE scatter plots — .sge_scatter_scales","text":"","code":".sge_scatter_scales(colours, shapes, fdr_threshold)"},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-sge_scatter_scales.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Shared scale and theme layers for SGE scatter plots — .sge_scatter_scales","text":"colours Named colour vector consequence types. shapes Named shape vector functional classifications. fdr_threshold FDR threshold alpha legend labels.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/dot-sge_scatter_scales.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Shared scale and theme layers for SGE scatter plots — .sge_scatter_scales","text":"list ggplot2 scale theme objects.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/estimate_size_factors.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate size factors from control data — estimate_size_factors","title":"Estimate size factors from control data — estimate_size_factors","text":"Estimates DESeq2 size factors using subset data (typically control oligos neutral variants) normalization across samples.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/estimate_size_factors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate size factors from control data — estimate_size_factors","text":"","code":"estimate_size_factors(   count_data,   col_data,   design = \"~ condition\",   min_row_sum = 10,   reference_level = NULL )"},{"path":"https://github.com/team113sanger/sgeasy/reference/estimate_size_factors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate size factors from control data — estimate_size_factors","text":"count_data matrix raw counts genes/variants rows samples columns. col_data data frame sample metadata. Must contain condition column. design formula string specifying experimental design (default: \"~ condition\"). min_row_sum Minimum total count across samples retain variant (default: 10). reference_level Reference level condition factor (default: NULL).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/estimate_size_factors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate size factors from control data — estimate_size_factors","text":"named numeric vector size factors, one per sample.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/estimate_size_factors.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate size factors from control data — estimate_size_factors","text":"function creates DESeqDataSet provided count matrix, filters low-count variants, estimates size factors using DESeq2's median--ratios method. size factors can applied separate count matrix normalization.","code":""},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/reference/estimate_size_factors.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate size factors from control data — estimate_size_factors","text":"","code":"if (FALSE) { # \\dontrun{ # Using synonymous variants for normalization size_factors <- estimate_size_factors(   count_data = norm_matrix,   col_data = sample_info,   reference_level = \"Day4\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/facades.html","id":null,"dir":"Reference","previous_headings":"","what":"Stage Wrapper Functions for SGE Analysis — facades","title":"Stage Wrapper Functions for SGE Analysis — facades","text":"facade functions provide simplified interfaces major stage SGE analysis workflow, designed integration UIs streamlined scripting.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ensembl.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch protein domains from Ensembl REST API — fetch_domains_ensembl","title":"Fetch protein domains from Ensembl REST API — fetch_domains_ensembl","text":"Retrieves protein domain annotations given transcript Ensembl REST API.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ensembl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch protein domains from Ensembl REST API — fetch_domains_ensembl","text":"","code":"fetch_domains_ensembl(   transcript_id,   species = \"human\",   domain_sources = NULL,   timeout = 30 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ensembl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch protein domains from Ensembl REST API — fetch_domains_ensembl","text":"transcript_id Character. Ensembl transcript ID (e.g., \"ENST00000355451\"). species Character. Species name (default: \"human\"). Currently unused reserved future multi-species support. domain_sources Character vector. Filter specific domain sources (e.g., c(\"Pfam\", \"SMART\")). NULL (default), returns sources. timeout Numeric. Request timeout seconds (default: 30).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ensembl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fetch protein domains from Ensembl REST API — fetch_domains_ensembl","text":"tibble columns: domain, source, start, end. Returns NULL domains found.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ensembl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fetch protein domains from Ensembl REST API — fetch_domains_ensembl","text":"function first looks protein ID associated transcript, fetches protein features annotated domains.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ensembl.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fetch protein domains from Ensembl REST API — fetch_domains_ensembl","text":"","code":"if (FALSE) { # \\dontrun{ domains <- fetch_domains_ensembl(\"ENST00000355451\") domains <- fetch_domains_ensembl(\"ENST00000355451\",                                   domain_sources = c(\"Pfam\", \"SMART\")) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_interpro.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch protein domains from InterPro REST API — fetch_domains_interpro","title":"Fetch protein domains from InterPro REST API — fetch_domains_interpro","text":"Retrieves protein domain annotations given UniProt accession InterPro REST API. InterPro aggregates domains multiple sources including Pfam, SMART, CDD, PROSITE, others.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_interpro.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch protein domains from InterPro REST API — fetch_domains_interpro","text":"","code":"fetch_domains_interpro(   uniprot_acc,   domain_sources = NULL,   entry_types = \"domain\",   timeout = 30 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_interpro.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch protein domains from InterPro REST API — fetch_domains_interpro","text":"uniprot_acc Character. UniProt accession (e.g., \"P04637\" p53). domain_sources Character vector. Filter specific domain sources (e.g., c(\"pfam\", \"smart\")). NULL (default), returns sources. Available sources include: pfam, smart, cdd, prosite, panther, etc. entry_types Character vector. Filter specific InterPro entry types (e.g., c(\"domain\", \"family\")). NULL (default), returns \"domain\". timeout Numeric. Request timeout seconds (default: 30).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_interpro.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fetch protein domains from InterPro REST API — fetch_domains_interpro","text":"tibble columns: domain, source, start, end, interpro_id. Returns NULL domains found.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_interpro.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fetch protein domains from InterPro REST API — fetch_domains_interpro","text":"InterPro API provides comprehensive domain annotations aggregated multiple member databases. domain entry includes InterPro accession mappings underlying member database signatures.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_interpro.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fetch protein domains from InterPro REST API — fetch_domains_interpro","text":"","code":"if (FALSE) { # \\dontrun{ # Fetch all domains for p53 domains <- fetch_domains_interpro(\"P04637\")  # Fetch only Pfam domains domains <- fetch_domains_interpro(\"P04637\", domain_sources = \"pfam\") } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ted.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch protein domains from TED (The Encyclopedia of Domains) — fetch_domains_ted","title":"Fetch protein domains from TED (The Encyclopedia of Domains) — fetch_domains_ted","text":"Retrieves consensus structural domain annotations given UniProt accession TED API. TED provides domain boundaries derived AlphaFold structures using consensus Chainsaw, Merizo, UniDoc.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ted.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch protein domains from TED (The Encyclopedia of Domains) — fetch_domains_ted","text":"","code":"fetch_domains_ted(uniprot_acc, consensus_levels = NULL, timeout = 30)"},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ted.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch protein domains from TED (The Encyclopedia of Domains) — fetch_domains_ted","text":"uniprot_acc Character. UniProt accession (e.g., \"Q8IVD9\"). consensus_levels Character vector. Filter specific consensus levels: \"high\", \"medium\", \"low\". NULL (default), returns . timeout Numeric. Request timeout seconds (default: 30).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ted.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fetch protein domains from TED (The Encyclopedia of Domains) — fetch_domains_ted","text":"tibble columns: domain, source, start, end, ted_id, consensus_level, cath_label, plddt. Returns NULL domains found.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ted.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fetch protein domains from TED (The Encyclopedia of Domains) — fetch_domains_ted","text":"TED (Encyclopedia Domains) provides structural domain annotations derived AlphaFold models. Domains identified using consensus three segmentation methods (Chainsaw, Merizo, UniDoc). High consensus means three methods agree; medium means two agree.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_domains_ted.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fetch protein domains from TED (The Encyclopedia of Domains) — fetch_domains_ted","text":"","code":"if (FALSE) { # \\dontrun{ # Fetch all TED domains domains <- fetch_domains_ted(\"Q8IVD9\")  # Fetch only high-confidence domains domains <- fetch_domains_ted(\"Q8IVD9\", consensus_levels = \"high\") } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_plddt_alphafold.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch per-residue pLDDT scores from AlphaFold Database — fetch_plddt_alphafold","title":"Fetch per-residue pLDDT scores from AlphaFold Database — fetch_plddt_alphafold","text":"Retrieves per-residue pLDDT (predicted Local Distance Difference Test) confidence scores AlphaFold Database given UniProt accession.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_plddt_alphafold.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch per-residue pLDDT scores from AlphaFold Database — fetch_plddt_alphafold","text":"","code":"fetch_plddt_alphafold(uniprot_acc, timeout = 30)"},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_plddt_alphafold.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch per-residue pLDDT scores from AlphaFold Database — fetch_plddt_alphafold","text":"uniprot_acc Character. UniProt accession (e.g., \"Q8IVD9\"). timeout Numeric. Request timeout seconds (default: 30).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_plddt_alphafold.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fetch per-residue pLDDT scores from AlphaFold Database — fetch_plddt_alphafold","text":"tibble columns: position, plddt, confidence_category. Returns NULL AlphaFold model available.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_plddt_alphafold.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fetch per-residue pLDDT scores from AlphaFold Database — fetch_plddt_alphafold","text":"pLDDT scores range 0 100: high (>90): High accuracy backbone sidechains Confident (70-90): Correct backbone, sidechain uncertainty Low (50-70): Low confidence low (<50): Often disordered flexible regions Confidence categories: \"H\" (high), \"M\" (medium), \"L\" (low), \"D\" (disordered).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/fetch_plddt_alphafold.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fetch per-residue pLDDT scores from AlphaFold Database — fetch_plddt_alphafold","text":"","code":"if (FALSE) { # \\dontrun{ plddt <- fetch_plddt_alphafold(\"Q8IVD9\")  # Plot pLDDT along protein library(ggplot2) ggplot(plddt, aes(x = position, y = plddt)) +   geom_line() +   geom_hline(yintercept = c(50, 70, 90), linetype = \"dashed\", alpha = 0.5) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_by_counts.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter variants by count thresholds — filter_by_counts","title":"Filter variants by count thresholds — filter_by_counts","text":"Removes variants total counts outside specified bounds optionally excludes specific sample patterns.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_by_counts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter variants by count thresholds — filter_by_counts","text":"","code":"filter_by_counts(   data,   min_counts = 10,   max_counts = Inf,   exclude_pattern = \"_0_\",   sample_pattern = \"count\" )"},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_by_counts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter variants by count thresholds — filter_by_counts","text":"data data frame count data. min_counts Minimum total count retain (default: 10). max_counts Maximum total count retain (default: Inf). exclude_pattern Pattern columns exclude output (default: \"0\"). Set NULL keep columns. sample_pattern Pattern identify sample columns count summation (default: \"count\").","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_by_counts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter variants by count thresholds — filter_by_counts","text":"Filtered data frame variants meeting count criteria.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_by_counts.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filter variants by count thresholds — filter_by_counts","text":"function calculates total count variant across sample columns matching sample_pattern using starts_with(), filters retain variants within specified count range. Optionally removes columns matching exclude_pattern (e.g., day 0 samples).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_by_counts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter variants by count thresholds — filter_by_counts","text":"","code":"if (FALSE) { # \\dontrun{ filtered_data <- filter_by_counts(   data = count_data,   min_counts = 10,   exclude_pattern = \"_0_\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_protein_altering_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter dataset to protein_altering variants for heatmap visualization — filter_protein_altering_variants","title":"Filter dataset to protein_altering variants for heatmap visualization — filter_protein_altering_variants","text":"Filters dataset keep protein_altering variants suitable amino acid heatmap visualization. Removes custom mutator variants, synonymous variants, variants without valid protein positions.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_protein_altering_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter dataset to protein_altering variants for heatmap visualization — filter_protein_altering_variants","text":"","code":"filter_protein_altering_variants(   data,   mutator_col = \"mutator\",   consequence_col = \"slim_consequence\",   amino_acids_col = \"Amino_acids\",   position_col = \"Protein_position\",   exclude_mutators = \"custom\",   exclude_consequences = \"synonymous\" )"},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_protein_altering_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter dataset to protein_altering variants for heatmap visualization — filter_protein_altering_variants","text":"data data frame containing variant information. mutator_col Character. Name mutator column (default: \"mutator\"). consequence_col Character. Name consequence column (default: \"slim_consequence\"). amino_acids_col Character. Name amino acids column (default: \"Amino_acids\"). position_col Character. Name protein position column (default: \"Protein_position\"). exclude_mutators Character vector. Mutator values exclude (default: \"custom\"). exclude_consequences Character vector. Consequence values exclude (default: \"synonymous\").","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_protein_altering_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter dataset to protein_altering variants for heatmap visualization — filter_protein_altering_variants","text":"tibble filtered variants AA_change column added.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/filter_protein_altering_variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter dataset to protein_altering variants for heatmap visualization — filter_protein_altering_variants","text":"","code":"if (FALSE) { # \\dontrun{ protein_altering_df <- filter_protein_altering_variants(combined_dataset) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/generate_qc_plots.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate QC plots — generate_qc_plots","title":"Generate QC plots — generate_qc_plots","text":"Creates quality control visualizations including sample distance matrices PCA plots.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/generate_qc_plots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate QC plots — generate_qc_plots","text":"","code":"generate_qc_plots(   rlog_results,   output_dir = \"results/qc\",   create_distance_matrices = TRUE,   create_pca_plots = TRUE )"},{"path":"https://github.com/team113sanger/sgeasy/reference/generate_qc_plots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate QC plots — generate_qc_plots","text":"rlog_results List rlog-transformed data targeton (analyze_screens()$rlog_results). output_dir Directory save plots (default: \"results/qc\"). create_distance_matrices Logical; create distance matrix plots (default: TRUE). create_pca_plots Logical; create PCA plots (default: TRUE).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/generate_qc_plots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate QC plots — generate_qc_plots","text":"Invisibly returns list created plot objects.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/generate_qc_plots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate QC plots — generate_qc_plots","text":"","code":"if (FALSE) { # \\dontrun{ generate_qc_plots(   rlog_results = results$rlog_results,   output_dir = \"results/qc\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/generate_results.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate analysis results — generate_results","title":"Generate analysis results — generate_results","text":"Post-processes contrast tables, creates result visualizations, optionally performs replicate reweighting.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/generate_results.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate analysis results — generate_results","text":"","code":"generate_results(   contrast_tables,   annotation,   output_dir = \"results\",   create_waterfall_plots = TRUE,   reweight_replicates = TRUE,   fdr_threshold = 0.01 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/generate_results.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate analysis results — generate_results","text":"contrast_tables Combined contrast table analyze_screens(). annotation Variant annotation data frame. output_dir Directory save results (default: \"results\"). create_waterfall_plots Logical; create waterfall plots (default: TRUE). reweight_replicates Logical; perform replicate reweighting (default: TRUE). fdr_threshold FDR threshold classification (default: 0.01).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/generate_results.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate analysis results — generate_results","text":"list containing: processed_data Post-processed contrast table reweighted_data Reweighted variant data (reweight_replicates = TRUE) plots List created plot objects","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/generate_results.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate analysis results — generate_results","text":"","code":"if (FALSE) { # \\dontrun{ final_results <- generate_results(   contrast_tables = results$contrast_tables,   annotation = data$annotation,   output_dir = \"results\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/get_replicated_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Find replicated variants — get_replicated_variants","title":"Find replicated variants — get_replicated_variants","text":"Identifies variants multiple observations (e.g., different oligos targeting HGVSc/HGVSp variant).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/get_replicated_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find replicated variants — get_replicated_variants","text":"","code":"get_replicated_variants(data)"},{"path":"https://github.com/team113sanger/sgeasy/reference/get_replicated_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find replicated variants — get_replicated_variants","text":"data data frame HGVSc HGVSp columns.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/get_replicated_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find replicated variants — get_replicated_variants","text":"Data frame containing variants one observation, n_observations column indicating many times variant appears.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/get_replicated_variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find replicated variants — get_replicated_variants","text":"","code":"if (FALSE) { # \\dontrun{ replicated <- get_replicated_variants(results) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/load_sge_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Load SGE data from files — load_sge_data","title":"Load SGE data from files — load_sge_data","text":"Loads count files, sample metadata, variant annotations. first stage SGE analysis workflow.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/load_sge_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load SGE data from files — load_sge_data","text":"","code":"load_sge_data(   count_files,   metadata_file,   annotation_file = NULL,   count_file_pattern = \"*lib_counts.tsv.gz\",   exclude_patterns = NULL,   metadata_join_by = \"sequencing_id\",   calculate_duration = TRUE )"},{"path":"https://github.com/team113sanger/sgeasy/reference/load_sge_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load SGE data from files — load_sge_data","text":"count_files Character vector paths count TSV files, directory path search count files. metadata_file Path sample metadata TSV file. annotation_file Path VEP annotation file. NULL, attempt extract metadata vep_anno column. count_file_pattern Glob pattern finding count files count_files directory (default: \"*lib_counts.tsv.gz\"). exclude_patterns Character vector patterns exclude count file discovery (default: NULL). metadata_join_by Column name metadata join SAMPLE column counts (default: \"sequencing_id\"). calculate_duration Logical; whether calculate duration condition column (default: TRUE).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/load_sge_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load SGE data from files — load_sge_data","text":"SGEData object containing: counts raw count data frame (access via @counts) metadata sample metadata data frame (access via @metadata) annotation variant annotation data frame (access via @annotation) complete_dataset Counts joined metadata (access via @complete_dataset)","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/load_sge_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load SGE data from files — load_sge_data","text":"","code":"if (FALSE) { # \\dontrun{ data <- load_sge_data(   count_files = \"inputs/\",   metadata_file = \"metadata/screen_metadata.tsv\",   annotation_file = \"annotations/vep_annotations.tsv\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/merge_overlapping_domains.html","id":null,"dir":"Reference","previous_headings":"","what":"Merge overlapping domain ranges — merge_overlapping_domains","title":"Merge overlapping domain ranges — merge_overlapping_domains","text":"Merges overlapping ranges domains name source using IRanges::reduce() efficient interval operations.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/merge_overlapping_domains.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Merge overlapping domain ranges — merge_overlapping_domains","text":"","code":"merge_overlapping_domains(domain_df)"},{"path":"https://github.com/team113sanger/sgeasy/reference/merge_overlapping_domains.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Merge overlapping domain ranges — merge_overlapping_domains","text":"domain_df data frame columns: domain, source, start, end.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/merge_overlapping_domains.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Merge overlapping domain ranges — merge_overlapping_domains","text":"tibble merged ranges (columns input).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/merge_overlapping_domains.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Merge overlapping domain ranges — merge_overlapping_domains","text":"","code":"if (FALSE) { # \\dontrun{ domains <- fetch_domains_ensembl(\"ENST00000355451\") merged <- merge_overlapping_domains(domains) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plddt_colours.html","id":null,"dir":"Reference","previous_headings":"","what":"AlphaFold pLDDT confidence colour scheme — plddt_colours","title":"AlphaFold pLDDT confidence colour scheme — plddt_colours","text":"named character vector colours pLDDT confidence categories, matching standard AlphaFold colour scheme.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plddt_colours.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"AlphaFold pLDDT confidence colour scheme — plddt_colours","text":"","code":"plddt_colours"},{"path":"https://github.com/team113sanger/sgeasy/reference/plddt_colours.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"AlphaFold pLDDT confidence colour scheme — plddt_colours","text":"object class character length 4.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_all_conditions.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate plots for all condition contrasts — plot_all_conditions","title":"Generate plots for all condition contrasts — plot_all_conditions","text":"Creates z-score plots contrasts found data.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_all_conditions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate plots for all condition contrasts — plot_all_conditions","text":"","code":"plot_all_conditions(   data,   targeton_id,   colours = consequence_colours,   shapes = classification_shapes )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_all_conditions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate plots for all condition contrasts — plot_all_conditions","text":"data data frame processed screen data. targeton_id Identifier targeton. colours Named vector colors (default: consequence_colours). shapes Named vector shapes (default: classification_shapes).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_all_conditions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate plots for all condition contrasts — plot_all_conditions","text":"named list ggplot objects, one per contrast.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_all_conditions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate plots for all condition contrasts — plot_all_conditions","text":"","code":"if (FALSE) { # \\dontrun{ plots <- plot_all_conditions(processed_data, \"GENE1\") } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_amino_acid_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot amino acid substitution heatmap — plot_amino_acid_heatmap","title":"Plot amino acid substitution heatmap — plot_amino_acid_heatmap","text":"Creates ggplot2 heatmap showing amino acid substitutions colored functional classification (enriched, depleted, unchanged).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_amino_acid_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot amino acid substitution heatmap — plot_amino_acid_heatmap","text":"","code":"plot_amino_acid_heatmap(   data,   x_range = NULL,   classification_colors = NULL,   show_x_axis = TRUE )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_amino_acid_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot amino acid substitution heatmap — plot_amino_acid_heatmap","text":"data data frame prepared prepare_amino_acid_heatmap_data. Must columns: Protein_position, new_aa, functional_classification. x_range Numeric vector length 2 specifying x-axis limits. NULL, determined data. classification_colors Named character vector colors functional classifications. NULL, uses classification_heatmap_colours. show_x_axis Logical. Whether show x-axis (default: TRUE).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_amino_acid_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot amino acid substitution heatmap — plot_amino_acid_heatmap","text":"ggplot2 object.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_amino_acid_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot amino acid substitution heatmap — plot_amino_acid_heatmap","text":"","code":"if (FALSE) { # \\dontrun{ plot_data <- prepare_amino_acid_heatmap_data(variant_results) plot_amino_acid_heatmap(plot_data) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_condition_scores.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot z-scores for a single condition contrast — plot_condition_scores","title":"Plot z-scores for a single condition contrast — plot_condition_scores","text":"Creates waterfall-style scatter plot showing variant z-scores along genomic coordinates, colored consequence type shaped functional classification.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_condition_scores.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot z-scores for a single condition contrast — plot_condition_scores","text":"","code":"plot_condition_scores(   data,   suffix,   targeton_id,   colours = consequence_colours,   shapes = classification_shapes,   fdr_threshold = 0.01 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_condition_scores.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot z-scores for a single condition contrast — plot_condition_scores","text":"data data frame adj_score, functional_classification, slim_consequence, vcf_pos, FDR columns. suffix contrast suffix (e.g., \"condition_Day7_vs_Day4\"). targeton_id Identifier targeton (used plot title). colours Named vector colors slim_consequence values (default: consequence_colours). shapes Named vector shapes functional_classification values (default: classification_shapes). fdr_threshold FDR threshold alpha transparency (default: 0.01).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_condition_scores.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot z-scores for a single condition contrast — plot_condition_scores","text":"ggplot object.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_condition_scores.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot z-scores for a single condition contrast — plot_condition_scores","text":"","code":"if (FALSE) { # \\dontrun{ p <- plot_condition_scores(   data = processed_data,   suffix = \"condition_Day7_vs_Day4\",   targeton_id = \"GENE1\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_consequence_jitter.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot jittered strip chart by group — plot_consequence_jitter","title":"Plot jittered strip chart by group — plot_consequence_jitter","text":"Creates jitter (strip) plot showing individual data points grouped categorical variable, optional median lines FDR-based transparency. Inspired Figure 1E Olvera-Leon et al. (2024) Cell.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_consequence_jitter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot jittered strip chart by group — plot_consequence_jitter","text":"","code":"plot_consequence_jitter(   data,   score_col,   group_col,   consequences = default_consequences,   fdr_col = NULL,   fdr_threshold = 0.01,   colours = consequence_colours,   xlab = group_col,   ylab = score_col,   show_median = TRUE,   point_size = 1,   jitter_width = 0.3 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_consequence_jitter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot jittered strip chart by group — plot_consequence_jitter","text":"data data frame containing score, grouping, optionally FDR columns. score_col Character. Name column containing numeric scores plot y-axis. group_col Character. Name column containing grouping variable (e.g., consequence type) x-axis. consequences Character vector. include rows group_col value vector. factor levels grouping variable set order. Set NULL include groups without filtering (default: default_consequences). fdr_col Character NULL. Name column containing FDR values. provided, points FDR >= fdr_threshold rendered semi-transparent. fdr_threshold Numeric. FDR cutoff full opacity (default: 0.01). colours Named character vector point colours keyed group values (default: consequence_colours). xlab Character. X-axis label (default: value group_col). ylab Character. Y-axis label (default: value score_col). show_median Logical. Whether draw horizontal median line per group (default: TRUE). point_size Size jittered points (default: 1). jitter_width Width horizontal jitter (default: 0.3).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_consequence_jitter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot jittered strip chart by group — plot_consequence_jitter","text":"ggplot object.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_consequence_jitter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot jittered strip chart by group — plot_consequence_jitter","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage plot_consequence_jitter(   data = results,   score_col = \"adj_score_condition_Day14_vs_Day4\",   group_col = \"slim_consequence\" )  # With FDR-based transparency and selected consequences plot_consequence_jitter(   data = results,   score_col = \"adj_score_condition_Day14_vs_Day4\",   group_col = \"slim_consequence\",   fdr_col = \"FDR_condition_Day14_vs_Day4\",   consequences = c(\"synonymous\", \"missense\", \"stop_gained\", \"frameshift\"),   ylab = \"z-score (D4-D14)\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_distance_matrices.html","id":null,"dir":"Reference","previous_headings":"","what":"Save distance matrix plots to files — plot_distance_matrices","title":"Save distance matrix plots to files — plot_distance_matrices","text":"Saves multiple sample distance matrix heatmaps PNG files.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_distance_matrices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save distance matrix plots to files — plot_distance_matrices","text":"","code":"plot_distance_matrices(   rlog_list,   output_dir = \"results/qc\",   width = 900,   height = 600 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_distance_matrices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save distance matrix plots to files — plot_distance_matrices","text":"rlog_list named list DESeqTransform objects matrices. output_dir Directory save plots (default: \"results/qc\"). width Plot width pixels (default: 900). height Plot height pixels (default: 600).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_distance_matrices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save distance matrix plots to files — plot_distance_matrices","text":"Invisibly returns NULL. Side effect: writes PNG files.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_distance_matrices.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save distance matrix plots to files — plot_distance_matrices","text":"","code":"if (FALSE) { # \\dontrun{ rlog_results <- map(deseq_results, pluck, \"rlog\") dist_matrices <- map(rlog_results, sample_distance_matrix) plot_distance_matrices(dist_matrices, output_dir = \"results/qc\") } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_domain_heatmap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot combined domain track and amino acid heatmap — plot_domain_heatmap","title":"Plot combined domain track and amino acid heatmap — plot_domain_heatmap","text":"High-level function creates combined visualization protein domains optionally pLDDT confidence scores shown amino acid substitution heatmap. Uses patchwork align x-axes.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_domain_heatmap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot combined domain track and amino acid heatmap — plot_domain_heatmap","text":"","code":"plot_domain_heatmap(   data,   uniprot_acc = NULL,   transcript_id = NULL,   domain_api = \"ted\",   domain_df = NULL,   plddt_df = NULL,   merge_domains = TRUE,   prepared = FALSE,   height_ratio = NULL,   domain_sources = NULL,   consensus_levels = NULL,   classification_colors = NULL,   domain_colors = NULL,   plddt_colors = NULL,   ... )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_domain_heatmap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot combined domain track and amino acid heatmap — plot_domain_heatmap","text":"data data frame containing variant data columns amino acid changes, positions, scores, FDR values. processed prepare_amino_acid_heatmap_data already prepared. uniprot_acc Character. UniProt accession fetching domains (e.g., \"P04637\"). Also used fetch pLDDT scores plddt_df = \"auto\". transcript_id Character. Ensembl transcript ID fetching domains (e.g., \"ENST00000355451\"). Used domain_api = \"ensembl\". domain_api Character. API use fetching domains: \"ted\" (default), \"interpro\", \"ensembl\". domain_df data frame domains. provided, skips API fetch. plddt_df data frame pLDDT scores returned fetch_plddt_alphafold, string \"auto\" fetch AlphaFold using uniprot_acc. NULL (default), pLDDT track shown. merge_domains Logical. Whether merge overlapping domains (default: TRUE). prepared Logical. Whether data already processed prepare_amino_acid_heatmap_data (default: FALSE). height_ratio Numeric vector. Relative heights tracks heatmap. Length depends number tracks: 2 elements domain + heatmap, 3 elements pLDDT + domain + heatmap. NULL, uses sensible defaults. domain_sources Character vector. Filter domains specific sources (e.g., c(\"pfam\", \"smart\") InterPro). consensus_levels Character vector. TED API : filter consensus level (\"high\", \"medium\", \"low\"). classification_colors Named character vector heatmap colors. domain_colors Named character vector domain colors. plddt_colors Named character vector pLDDT confidence category colors (H, M, L, D). ... Additional arguments passed prepare_amino_acid_heatmap_data.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_domain_heatmap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot combined domain track and amino acid heatmap — plot_domain_heatmap","text":"patchwork object combining tracks heatmap.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_domain_heatmap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot combined domain track and amino acid heatmap — plot_domain_heatmap","text":"","code":"if (FALSE) { # \\dontrun{ # With domain track only p <- plot_domain_heatmap(   data = variant_results,   uniprot_acc = \"P04637\",   domain_api = \"ted\" )  # With pLDDT track (auto-fetch from AlphaFold) p <- plot_domain_heatmap(   data = variant_results,   uniprot_acc = \"P04637\",   plddt_df = \"auto\" )  # With pre-fetched pLDDT data plddt <- fetch_plddt_alphafold(\"P04637\") p <- plot_domain_heatmap(   data = variant_results,   uniprot_acc = \"P04637\",   plddt_df = plddt )  # Save to file ggplot2::ggsave(   \"domain_heatmap.png\", p,   width = 8, height = 7, dpi = 600 ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_domain_track.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot protein domain track — plot_domain_track","title":"Plot protein domain track — plot_domain_track","text":"Creates ggplot2 visualization protein domains colored rectangles. Designed combined plots using patchwork.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_domain_track.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot protein domain track — plot_domain_track","text":"","code":"plot_domain_track(   domain_df,   x_range = NULL,   show_legend = TRUE,   domain_colors = NULL,   show_x_axis = FALSE )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_domain_track.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot protein domain track — plot_domain_track","text":"domain_df data frame columns: domain, source, start, end. x_range Numeric vector length 2 specifying x-axis limits. NULL, determined data. show_legend Logical. Whether show domain legend (default: TRUE). domain_colors Named character vector colors domains. NULL, uses default ggplot2 colors. show_x_axis Logical. Whether show x-axis (default: FALSE). Set TRUE using standalone plot.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_domain_track.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot protein domain track — plot_domain_track","text":"ggplot2 object.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_domain_track.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot protein domain track — plot_domain_track","text":"","code":"if (FALSE) { # \\dontrun{ domains <- fetch_domains_ensembl(\"ENST00000355451\") merged <- merge_overlapping_domains(domains) plot_domain_track(merged) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_gene_level_waterfall.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot functional scores along genomic coordinates — plot_gene_level_waterfall","title":"Plot functional scores along genomic coordinates — plot_gene_level_waterfall","text":"Creates waterfall-style scatter plot showing variant scores along genomic coordinates, colored consequence type shaped functional classification. Supports optional faceting grouping variable exon. Column names fully configurable.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_gene_level_waterfall.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot functional scores along genomic coordinates — plot_gene_level_waterfall","text":"","code":"plot_gene_level_waterfall(   data,   score_col,   pos_col = \"vcf_pos\",   consequence_col = \"slim_consequence\",   class_col = \"functional_classification\",   fdr_col = \"FDR\",   fdr_threshold = 0.01,   facet_col = NULL,   facet_nrow = 1,   title = NULL,   xlab = \"GRCh38 coordinate\",   ylab = score_col,   colours = consequence_colours,   shapes = classification_shapes,   point_size = 1.5 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_gene_level_waterfall.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot functional scores along genomic coordinates — plot_gene_level_waterfall","text":"data data frame containing columns referenced parameters. score_col Character. Name column containing numeric score plot y-axis. pos_col Character. Name column containing genomic coordinate x-axis (default: \"vcf_pos\"). consequence_col Character. Name column containing consequence annotations colour mapping (default: \"slim_consequence\"). class_col Character NULL. Name column containing functional classifications point shapes. NULL, shape mapping applied (default: \"functional_classification\"). fdr_col Character NULL. Name column containing FDR values alpha transparency. NULL, points fully opaque (default: \"FDR\"). fdr_threshold Numeric. FDR cutoff alpha transparency (default: 0.01). facet_col Character NULL. Name column facet (e.g., \"Exons\"). NULL, faceting applied (default: NULL). facet_nrow Integer. Number rows facet layout (default: 1). title Character NULL. Plot title. NULL, title shown (default: NULL). xlab Character. X-axis label (default: \"GRCh38 coordinate\"). ylab Character. Y-axis label (default: value score_col). colours Named character vector colours consequence values (default: consequence_colours). shapes Named numeric vector shapes classification values (default: classification_shapes). point_size Numeric. Size points (default: 1.5).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_gene_level_waterfall.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot functional scores along genomic coordinates — plot_gene_level_waterfall","text":"ggplot object.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_gene_level_waterfall.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot functional scores along genomic coordinates — plot_gene_level_waterfall","text":"","code":"if (FALSE) { # \\dontrun{ plot_gene_level_waterfall(   data = combined_dataset,   score_col = \"combined_lfc\",   class_col = \"functional_classification\",   fdr_col = \"FDR\",   facet_col = \"Exons\",   title = \"Functional score Plot: NUDCD3 - Weighted LFC\",   ylab = \"Functional score (Weighted LFC)\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_plddt_track.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot pLDDT confidence track — plot_plddt_track","title":"Plot pLDDT confidence track — plot_plddt_track","text":"Creates ggplot2 track showing per-residue AlphaFold pLDDT confidence scores, coloured confidence category using standard AlphaFold colour scheme.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_plddt_track.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot pLDDT confidence track — plot_plddt_track","text":"","code":"plot_plddt_track(   plddt_df,   x_range = NULL,   show_legend = TRUE,   plddt_colors = NULL,   show_x_axis = FALSE )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_plddt_track.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot pLDDT confidence track — plot_plddt_track","text":"plddt_df data frame returned fetch_plddt_alphafold, columns: position, plddt, confidence_category. x_range Numeric vector length 2 specifying x-axis limits. NULL, determined data. show_legend Logical. Whether show colour legend (default: TRUE). plddt_colors Named character vector colours confidence categories (H, M, L, D). NULL, uses plddt_colours. show_x_axis Logical. Whether show x-axis (default: FALSE).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_plddt_track.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot pLDDT confidence track — plot_plddt_track","text":"ggplot2 object.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_plddt_track.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot pLDDT confidence track — plot_plddt_track","text":"","code":"if (FALSE) { # \\dontrun{ plddt <- fetch_plddt_alphafold(\"Q8IVD9\") plot_plddt_track(plddt) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_position_effects.html","id":null,"dir":"Reference","previous_headings":"","what":"Save position effect ratio plots to files — plot_position_effects","title":"Save position effect ratio plots to files — plot_position_effects","text":"Saves multiple position effect ratio plots PNG files.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_position_effects.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save position effect ratio plots to files — plot_position_effects","text":"","code":"plot_position_effects(   pep_list,   output_dir = \"results/plasmid_ratio\",   timepoint = \"Day4\",   width = 900,   height = 600 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_position_effects.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save position effect ratio plots to files — plot_position_effects","text":"pep_list named list data frames calculate_position_effect(). output_dir Directory save plots (default: \"results/plasmid_ratio\"). timepoint Character string specifying timepoint (default: \"Day4\"). width Plot width pixels (default: 900). height Plot height pixels (default: 600).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_position_effects.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save position effect ratio plots to files — plot_position_effects","text":"Invisibly returns NULL. Side effect: writes PNG files.","code":""},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_position_effects.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save position effect ratio plots to files — plot_position_effects","text":"","code":"if (FALSE) { # \\dontrun{ plot_position_effects(pep_list, output_dir = \"results/plasmid_ratio\") } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_ridgeline.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot ridgeline density distributions by group — plot_ridgeline","title":"Plot ridgeline density distributions by group — plot_ridgeline","text":"Creates ridgeline (joy) plot showing density distribution numeric score across groups, jittered data points overlaid. Useful comparing score distributions across variant consequence categories.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_ridgeline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot ridgeline density distributions by group — plot_ridgeline","text":"","code":"plot_ridgeline(   data,   score_col,   group_col,   consequences = default_consequences,   colours = consequence_colours,   xlab = score_col,   ylab = \"Density\",   point_shape = \"|\",   point_size = 3,   alpha = 0.7 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_ridgeline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot ridgeline density distributions by group — plot_ridgeline","text":"data data frame containing score grouping columns. score_col Character. Name column containing numeric scores plot x-axis. group_col Character. Name column containing grouping variable (e.g., consequence type) y-axis ridges. consequences Character vector. include rows group_col value vector. factor levels grouping variable set order. Set NULL include groups without filtering (default: default_consequences). colours Named character vector fill colours keyed group values (default: consequence_colours). xlab Character. X-axis label (default: value score_col). ylab Character. Y-axis label (default: \"Density\"). point_shape Shape jittered points (default: \"|\"). point_size Size jittered points (default: 3). alpha Ridge fill transparency (default: 0.7).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_ridgeline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot ridgeline density distributions by group — plot_ridgeline","text":"ggplot object.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_ridgeline.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot ridgeline density distributions by group — plot_ridgeline","text":"","code":"if (FALSE) { # \\dontrun{ plot_ridgeline(   data = results,   score_col = \"adj_score_condition_Day7_vs_Day4\",   group_col = \"slim_consequence\" )  # With specific consequences in a custom order plot_ridgeline(   data = results,   score_col = \"adj_score_condition_Day7_vs_Day4\",   group_col = \"slim_consequence\",   consequences = c(\"synonymous\", \"missense\", \"stop_gained\"),   xlab = \"z-score (Day7 vs Day4)\",   ylab = \"Consequence\" ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_sample_scatter.html","id":null,"dir":"Reference","previous_headings":"","what":"Create sample comparison scatter plots — plot_sample_scatter","title":"Create sample comparison scatter plots — plot_sample_scatter","text":"Generates matrix pairwise scatter plots samples, useful visualizing replicate correlation batch effects.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_sample_scatter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create sample comparison scatter plots — plot_sample_scatter","text":"","code":"plot_sample_scatter(   data,   sample_names,   point_size = 0.4,   line_color = \"blue\",   title = \"Regularized-log Transformed Read Count\" )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_sample_scatter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create sample comparison scatter plots — plot_sample_scatter","text":"data matrix DESeqTransform object transformed counts (e.g., rlog). DESeqTransform, assay extracted. sample_names Character vector sample names include plot. point_size Size scatter plot points (default: 0.4). line_color Color regression line (default: \"blue\"). title Plot title (default: \"Regularized-log Transformed Read Count\").","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_sample_scatter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create sample comparison scatter plots — plot_sample_scatter","text":"Invisibly returns ggmatrix plot object. plot also printed current graphics device.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_sample_scatter.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create sample comparison scatter plots — plot_sample_scatter","text":"function creates pairs plot using GGally::ggpairs() showing pairwise scatter plots selected samples. panel includes: Scatter points showing variant abundance sample pair Linear regression line correlation visualization Correlation coefficients upper triangle useful assessing replicate consistency identifying potential batch effects outlier samples.","code":""},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_sample_scatter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create sample comparison scatter plots — plot_sample_scatter","text":"","code":"if (FALSE) { # \\dontrun{ # Plot Day4 replicates plot_sample_scatter(   data = assay(results$rlog),   sample_names = c(\"SAMPLE_A_4_pel\", \"SAMPLE_B_4_pel\") )  # Or pass the rlog object directly plot_sample_scatter(   data = results$rlog,   sample_names = c(\"SAMPLE_A_4_pel\", \"SAMPLE_B_4_pel\") ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_screen_pcas.html","id":null,"dir":"Reference","previous_headings":"","what":"Save PCA plots to files — plot_screen_pcas","title":"Save PCA plots to files — plot_screen_pcas","text":"Saves multiple sample PCA plots PNG files.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_screen_pcas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save PCA plots to files — plot_screen_pcas","text":"","code":"plot_screen_pcas(   rlog_list,   output_dir = \"results/qc\",   width = 900,   height = 600,   intgroup = c(\"condition\", \"replicate\") )"},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_screen_pcas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save PCA plots to files — plot_screen_pcas","text":"rlog_list named list DESeqTransform objects. output_dir Directory save plots (default: \"results/qc\"). width Plot width pixels (default: 900). height Plot height pixels (default: 600). intgroup Character vector variables use grouping (default: c(\"condition\", \"replicate\")).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_screen_pcas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Save PCA plots to files — plot_screen_pcas","text":"Invisibly returns NULL. Side effect: writes PNG files.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/plot_screen_pcas.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Save PCA plots to files — plot_screen_pcas","text":"","code":"if (FALSE) { # \\dontrun{ rlog_results <- map(deseq_results, pluck, \"rlog\") plot_screen_pcas(rlog_results, output_dir = \"results/qc\") } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/position_effect_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot position effect ratios — position_effect_plot","title":"Plot position effect ratios — position_effect_plot","text":"Creates scatter plot showing ratio counts specified timepoint versus Day0 across genomic coordinates, colored consequence type loess smoothing line.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/position_effect_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot position effect ratios — position_effect_plot","text":"","code":"position_effect_plot(pos_ratio, timepoint, colours = consequence_colours)"},{"path":"https://github.com/team113sanger/sgeasy/reference/position_effect_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot position effect ratios — position_effect_plot","text":"pos_ratio data frame calculate_position_effect() containing vcf_pos, ratio, slim_consequence columns. timepoint Character string specifying timepoint (used y-axis label, e.g., \"Day10\"). colours Named vector colors slim_consequence values","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/position_effect_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot position effect ratios — position_effect_plot","text":"ggplot object (invisibly). plot also printed.","code":""},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/reference/position_effect_plot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot position effect ratios — position_effect_plot","text":"","code":"if (FALSE) { # \\dontrun{ pos_effect <- calculate_position_effect(count_data, annotation, \"Day10\") position_effect_plot(pos_effect, \"Day10\") } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/post_process.html","id":null,"dir":"Reference","previous_headings":"","what":"Post-process screen results with annotation — post_process","title":"Post-process screen results with annotation — post_process","text":"Combines differential analysis results variant annotations, applies statistical adjustments, simplifies consequence types.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/post_process.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Post-process screen results with annotation — post_process","text":"","code":"post_process(data, annotation, targeton_id = NULL, fdr_threshold = 0.01)"},{"path":"https://github.com/team113sanger/sgeasy/reference/post_process.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Post-process screen results with annotation — post_process","text":"data data frame contrast results differential analysis. Targeton_ID column already exists (e.g., using map_dfr .id = \"Targeton_ID\"), used joining. annotation data frame variant annotations. Must contain Seq Targeton_ID columns joining. targeton_id Optional character string identifying targeton. used Targeton_ID column exist data. fdr_threshold FDR threshold functional classification (default: 0.01).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/post_process.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Post-process screen results with annotation — post_process","text":"Data frame annotations, adjusted statistics, functional classifications, simplified consequence types.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/post_process.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Post-process screen results with annotation — post_process","text":"function provides complete post-processing pipeline: Adds targeton identifier data (already present) Joins annotation file SEQUENCE Targeton_ID Applies recalculate_screen_statistics() statistical adjustment Applies slim_consequence() consequence simplification function supports two workflows: Single targeton: provide targeton_id parameter Multiple targetons: use map_dfr(..., .id = \"Targeton_ID\") pattern Targeton_ID already data","code":""},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/reference/post_process.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Post-process screen results with annotation — post_process","text":"","code":"if (FALSE) { # \\dontrun{ # Single targeton workflow processed <- post_process(   data = contrast_summary,   annotation = vep_annotations,   targeton_id = \"GENE1_exon2\" )  # Multiple targeton workflow (Targeton_ID already in data) contrast_tables <- map_dfr(deseq_results, pluck, \"contrast_summary\",                            .id = \"Targeton_ID\") processed <- post_process(   data = contrast_tables,   annotation = vep_annotations ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_amino_acid_heatmap_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for amino acid heatmap visualization — prepare_amino_acid_heatmap_data","title":"Prepare data for amino acid heatmap visualization — prepare_amino_acid_heatmap_data","text":"Filters aggregates variant data creating amino acid substitution heatmap. Groups amino acid change computes mean scores FDR, classifies variants enriched, depleted, unchanged.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_amino_acid_heatmap_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for amino acid heatmap visualization — prepare_amino_acid_heatmap_data","text":"","code":"prepare_amino_acid_heatmap_data(   data,   score_col = \"adj_score_continuous\",   fdr_col = \"FDR_continuous\",   fdr_threshold = 0.01,   amino_acids_col = \"Amino_acids\",   position_col = \"Protein_position\" )"},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_amino_acid_heatmap_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare data for amino acid heatmap visualization — prepare_amino_acid_heatmap_data","text":"data data frame containing variant information. score_col Character. Name score column (default: \"adj_score_continuous\"). fdr_col Character. Name FDR column (default: \"FDR_continuous\"). fdr_threshold Numeric. FDR threshold significance (default: 0.01). amino_acids_col Character. Name column containing amino acid change format \"X/Y\" (default: \"Amino_acids\"). position_col Character. Name protein position column","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_amino_acid_heatmap_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare data for amino acid heatmap visualization — prepare_amino_acid_heatmap_data","text":"tibble columns: AA_change, previous, new_aa, Protein_position, mean_adj_score, mean_FDR, functional_classification.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_amino_acid_heatmap_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare data for amino acid heatmap visualization — prepare_amino_acid_heatmap_data","text":"function: Creates AA_change identifier (e.g., \"A123V\") Groups unique amino acid changes computes mean score/FDR Classifies based FDR threshold score direction Converts special characters: \"*\" -> \"stop_scan\", \"-\" -> \"codon_deletion\", \"X\" -> \"frameshift\" Orders new_aa factor using amino_acid_order","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_amino_acid_heatmap_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare data for amino acid heatmap visualization — prepare_amino_acid_heatmap_data","text":"","code":"if (FALSE) { # \\dontrun{ plot_data <- prepare_amino_acid_heatmap_data(variant_results) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_count_matrices.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare count matrices for analysis — prepare_count_matrices","title":"Prepare count matrices for analysis — prepare_count_matrices","text":"Transforms loaded data analysis-ready count matrices. includes filtering, pivoting, deduplication, annotation joining, artefact removal.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_count_matrices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare count matrices for analysis — prepare_count_matrices","text":"","code":"prepare_count_matrices(   data,   annotation = NULL,   exclude_samples = NULL,   exclude_targetons = NULL,   min_counts = 10,   sample_col = \"supplier_name\",   count_col = \"COUNT\",   targeton_col = \"targeton_id\" )"},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_count_matrices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare count matrices for analysis — prepare_count_matrices","text":"data SGEData object load_sge_data(), data frame containing complete dataset (counts joined metadata). annotation Data frame variant annotations. data SGEData object, extracted automatically can omitted. exclude_samples Character vector sample names exclude (default: NULL). exclude_targetons Character vector targeton IDs exclude (default: NULL). min_counts Minimum total count threshold (default: 10). sample_col Column name sample identifier (default: \"supplier_name\"). count_col Column name count values (default: \"COUNT\"). targeton_col Column name targeton ID (default: \"targeton_id\").","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_count_matrices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare count matrices for analysis — prepare_count_matrices","text":"list containing: annotated_counts List annotated count data frames targeton normalisation_matrices List normalization matrices targeton complete_matrices List full count matrices targeton targeton_ids Character vector targeton IDs","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_count_matrices.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare count matrices for analysis — prepare_count_matrices","text":"","code":"if (FALSE) { # \\dontrun{ # Using SGEData object (recommended) matrices <- prepare_count_matrices(   data = sge_data,   exclude_samples = c(\"bad_sample_1\"),   min_counts = 10 )  # Using data frames directly matrices <- prepare_count_matrices(   data = complete_dataset,   annotation = annotation_df,   min_counts = 10 ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_gene_level_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare gene-level dataset from targeton results — prepare_gene_level_data","title":"Prepare gene-level dataset from targeton results — prepare_gene_level_data","text":"Combines results multiple targetons (exons) single gene-level dataset suitable visualization aggregated analysis.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_gene_level_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare gene-level dataset from targeton results — prepare_gene_level_data","text":"","code":"prepare_gene_level_data(   data,   exon_col = \"EXON\",   exon_pattern = \"/\\\\d+$\",   exon_levels = NULL,   reweight = TRUE,   fdr_threshold = 0.01 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_gene_level_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare gene-level dataset from targeton results — prepare_gene_level_data","text":"data data frame processed contrast results containing Targeton_ID EXON columns. exon_col Column name containing exon information (default: \"EXON\"). exon_pattern Regex pattern extract exon number exon_col (default: \"/\\d+$\" removes denominator like \"/6\" \"1/6\"). exon_levels Character vector exon factor levels ordering. NULL, levels determined automatically descending order. reweight Logical; whether compute reweighted scores replicated variants across gene (default: TRUE). fdr_threshold FDR threshold functional classification reweighted results (default: 0.01).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_gene_level_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare gene-level dataset from targeton results — prepare_gene_level_data","text":"list containing: gene_data Data frame variants Exons factor column faceting exon_annotations Data frame mapping Targeton_ID Exons reweighted Data frame reweighted variant scores (reweight = TRUE), NULL combined Gene data joined reweighted scores (reweight = TRUE), NULL","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/prepare_gene_level_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare gene-level dataset from targeton results — prepare_gene_level_data","text":"","code":"if (FALSE) { # \\dontrun{ # Basic usage gene_results <- prepare_gene_level_data(processed_contrast_tables)  # Access components gene_results$gene_data       # For plotting individual variants gene_results$reweighted      # Aggregated scores per unique variant gene_results$combined        # Combined for weighted score plots  # Custom exon ordering gene_results <- prepare_gene_level_data(   data = processed_data,   exon_levels = c(\"6\", \"5\", \"4\", \"3\", \"2\", \"1\") ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/recalculate_screen_statistics.html","id":null,"dir":"Reference","previous_headings":"","what":"Recalculate screen statistics — recalculate_screen_statistics","title":"Recalculate screen statistics — recalculate_screen_statistics","text":"Applies full post-processing pipeline: calculates medians neutral variants, adjusts contrasts, classifies variants.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/recalculate_screen_statistics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Recalculate screen statistics — recalculate_screen_statistics","text":"","code":"recalculate_screen_statistics(data, fdr_threshold = 0.01)"},{"path":"https://github.com/team113sanger/sgeasy/reference/recalculate_screen_statistics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recalculate screen statistics — recalculate_screen_statistics","text":"data data frame contrast results differential analysis. Must contain Consequence column identifying neutral variants. fdr_threshold FDR threshold functional classification (default: 0.01).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/recalculate_screen_statistics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Recalculate screen statistics — recalculate_screen_statistics","text":"Data frame computed statistics classifications.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/recalculate_screen_statistics.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Recalculate screen statistics — recalculate_screen_statistics","text":"function applies standard SGE post-processing pipeline: Calculates median log2FoldChange neutral variants (synonymous intronic) using calculate_median_scores() Adjusts contrasts subtracting medians computing z-scores using adjust_all_contrasts() Classifies variants depleted/enriched/unchanged based FDR using classify_all_contrasts()","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/recalculate_screen_statistics.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Recalculate screen statistics — recalculate_screen_statistics","text":"","code":"if (FALSE) { # \\dontrun{ processed_data <- recalculate_screen_statistics(contrast_summary)  # With custom FDR threshold processed_data <- recalculate_screen_statistics(   contrast_summary,   fdr_threshold = 0.05 ) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/remove_artefacts.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove artefact variants — remove_artefacts","title":"Remove artefact variants — remove_artefacts","text":"Filters variants lack valid sgRNA identifier, typically indicates artefact sequences excluded analysis.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/remove_artefacts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove artefact variants — remove_artefacts","text":"","code":"remove_artefacts(data)"},{"path":"https://github.com/team113sanger/sgeasy/reference/remove_artefacts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove artefact variants — remove_artefacts","text":"data data frame sgRNA_id column.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/remove_artefacts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove artefact variants — remove_artefacts","text":"Data frame artefact rows (NA sgRNA_id) removed.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/remove_artefacts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove artefact variants — remove_artefacts","text":"","code":"if (FALSE) { # \\dontrun{ cleaned_data <- remove_artefacts(annotated_counts) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/reweight_replicated_variants.html","id":null,"dir":"Reference","previous_headings":"","what":"Reweight replicated variants using inverse variance weighting — reweight_replicated_variants","title":"Reweight replicated variants using inverse variance weighting — reweight_replicated_variants","text":"Combines measurements replicated variants (HGVSc/HGVSp) using inverse variance weighting. PAM-impacted observations -weighted non-PAM alternatives exist.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/reweight_replicated_variants.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reweight replicated variants using inverse variance weighting — reweight_replicated_variants","text":"","code":"reweight_replicated_variants(data, fdr_threshold = 0.01)"},{"path":"https://github.com/team113sanger/sgeasy/reference/reweight_replicated_variants.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reweight replicated variants using inverse variance weighting — reweight_replicated_variants","text":"data data frame HGVSc, HGVSp, pam_mut_sgrna_id, lfcSE_continuous, adj_lfc_continuous columns. fdr_threshold FDR threshold functional classification (default: 0.01).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/reweight_replicated_variants.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reweight replicated variants using inverse variance weighting — reweight_replicated_variants","text":"Data frame one row per unique HGVSc/HGVSp combination, containing: HGVSc, HGVSp Variant identifiers n_total Total number observations n_pam Number PAM-impacted observations n_used Number observations used (weight > 0) pam_only Logical; TRUE PAM observations exist combined_lfc Weighted average log fold change combined_SE Standard error combined estimate combined_Z Z-score combined estimate pval Two-sided p-value FDR Benjamini-Hochberg adjusted p-value functional_classification depleted/enriched/unchanged","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/reweight_replicated_variants.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Reweight replicated variants using inverse variance weighting — reweight_replicated_variants","text":"weighting strategy prioritizes non-PAM observations: Non-PAM observations always receive weight = 1/SE^2 PAM observations receive zero weight non-PAM alternatives exist PAM-variants use normal weighting (better nothing)","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/reweight_replicated_variants.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reweight replicated variants using inverse variance weighting — reweight_replicated_variants","text":"","code":"if (FALSE) { # \\dontrun{ weighted_results <- reweight_replicated_variants(variant_data) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/run_differential_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Run differential abundance analysis — run_differential_analysis","title":"Run differential abundance analysis — run_differential_analysis","text":"Performs DESeq2-based differential abundance analysis SGE screen data, using control oligos size factor normalization.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/run_differential_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run differential abundance analysis — run_differential_analysis","text":"","code":"run_differential_analysis(   count_matrix,   normalization_matrix,   sample_metadata,   condition_levels = c(\"Day4\", \"Day7\", \"Day10\", \"Day15\"),   shrinkage_type = \"normal\",   alpha = 0.05,   include_rate = TRUE,   sample_prefix = \"count_\" )"},{"path":"https://github.com/team113sanger/sgeasy/reference/run_differential_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run differential abundance analysis — run_differential_analysis","text":"count_matrix Numeric matrix variant counts sequences row names samples columns. normalization_matrix Matrix neutral variants size factor estimation (e.g., synonymous/intronic variants). sample_metadata Data frame sample information. Must contain condition, duration, supplier_name columns. condition_levels Character vector specifying condition factor levels order (default: c(\"Day4\", \"Day7\", \"Day10\", \"Day15\")). shrinkage_type Type LFC shrinkage: \"normal\", \"apeglm\", \"ashr\" (default: \"normal\"). alpha Significance threshold adjusted p-values (default: 0.05). include_rate Logical; whether include continuous rate analysis (default: TRUE). sample_prefix Prefix used sample column names count matrix (default: \"count_\"). Set \"\" column names match supplier_name directly.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/run_differential_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run differential abundance analysis — run_differential_analysis","text":"SGEResults object containing: results DESeq2 results table tibble SEQUENCE column (access via @results) rlog Regularized log-transformed DESeqDataSet object (access via @rlog) contrast_summary Combined summary across contrasts including log2 fold changes, p-values, z-scores, rate estimates (access via @contrast_summary) metadata Analysis parameters including condition_levels, shrinkage_type, alpha, analysis_date (access via @metadata)","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/run_differential_analysis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run differential abundance analysis — run_differential_analysis","text":"function implements full SGE differential abundance pipeline: Extracts condition information metadata samples matrix Estimates size factors neutral variants (synonymous/intronic) Creates DESeqDataSet proper experimental design Applies control-derived size factors variants Runs DESeq2 Wald tests condition contrasts Computes regularized log transformation visualization Generates z-scores across samples variant Optionally runs continuous analysis rate estimation control-based normalization strategy accounts differences library size avoiding bias variants selection.","code":""},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/reference/run_differential_analysis.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run differential abundance analysis — run_differential_analysis","text":"","code":"if (FALSE) { # \\dontrun{ results <- run_differential_analysis(   count_matrix = counts,   normalization_matrix = norm_counts,   sample_metadata = metadata )  # Access components using @ deseq_results <- results@results rlog_data <- results@rlog summary_table <- results@contrast_summary analysis_params <- results@metadata } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/sample_distance_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Create sample distance matrix heatmap — sample_distance_matrix","title":"Create sample distance matrix heatmap — sample_distance_matrix","text":"Computes sample--sample distance matrix regularized log-transformed data displays heatmap.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/sample_distance_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create sample distance matrix heatmap — sample_distance_matrix","text":"","code":"sample_distance_matrix(rlog_data, color_palette = NULL)"},{"path":"https://github.com/team113sanger/sgeasy/reference/sample_distance_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create sample distance matrix heatmap — sample_distance_matrix","text":"rlog_data DESeqTransform object (output DESeq2::rlog()) matrix transformed counts. color_palette Color palette heatmap. Default uses reversed Blues palette.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/sample_distance_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create sample distance matrix heatmap — sample_distance_matrix","text":"pheatmap object (invisibly). heatmap also printed.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/sample_distance_matrix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create sample distance matrix heatmap — sample_distance_matrix","text":"","code":"if (FALSE) { # \\dontrun{ sample_distance_matrix(results$rlog) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/sgeasy-classes.html","id":null,"dir":"Reference","previous_headings":"","what":"S7 Class Definitions for sgeasy — sgeasy-classes","title":"S7 Class Definitions for sgeasy — sgeasy-classes","text":"S7 class definitions SGE analysis data results. classes provide formal containers validation clean print methods improved REPL experience.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/sgeasy-package.html","id":null,"dir":"Reference","previous_headings":"","what":"sgeasy: Downstream Analysis for Saturation Genome Editing Screens — sgeasy-package","title":"sgeasy: Downstream Analysis for Saturation Genome Editing Screens — sgeasy-package","text":"Provides tools analyzing saturation genome editing (SGE) screen data, including normalization using control oligos, differential abundance analysis DESeq2, visualization utilities.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/sgeasy-package.html","id":"main-functions","dir":"Reference","previous_headings":"","what":"Main functions","title":"sgeasy: Downstream Analysis for Saturation Genome Editing Screens — sgeasy-package","text":"run_differential_analysis Run complete differential abundance analysis pipeline create_normalization_matrix Create matrix neutral variants normalization create_count_matrix Create count matrix annotated data filter_by_counts Filter variants count thresholds estimate_size_factors Estimate DESeq2 size factors plot_sample_scatter Create sample comparison plots remove_artefacts Remove artefact variants reweight_replicated_variants Combine replicated variants using inverse variance weighting sample_distance_matrix Create sample distance heatmap build_sample_pca Build PCA plot rlog data","code":""},{"path":[]},{"path":"https://github.com/team113sanger/sgeasy/reference/sgeasy-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"sgeasy: Downstream Analysis for Saturation Genome Editing Screens — sgeasy-package","text":"Maintainer: Jamie Billington jb63@sanger.ac.uk Authors: Andrew Waters aw29@sanger.ac.uk","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/slim_consequence.html","id":null,"dir":"Reference","previous_headings":"","what":"Simplify variant consequence annotations — slim_consequence","title":"Simplify variant consequence annotations — slim_consequence","text":"Creates simplified consequence annotation column mapping VEP consequences reduced set categories, considering mutator type relevant.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/slim_consequence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simplify variant consequence annotations — slim_consequence","text":"","code":"slim_consequence(data)"},{"path":"https://github.com/team113sanger/sgeasy/reference/slim_consequence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simplify variant consequence annotations — slim_consequence","text":"data data frame Consequence mutator columns.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/slim_consequence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simplify variant consequence annotations — slim_consequence","text":"Data frame additional slim_consequence column.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/slim_consequence.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simplify variant consequence annotations — slim_consequence","text":"function maps VEP consequences simplified categories: Clinical inframe deletions/insertions (custom mutator) Synonymous (including stop_retained appropriate mutators) Start/stop lost variants Codon deletions (inframe mutator) Stop gained, frameshift, splice variants Missense, intron, UTR variants","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/slim_consequence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simplify variant consequence annotations — slim_consequence","text":"","code":"if (FALSE) { # \\dontrun{ data_with_slim <- slim_consequence(annotated_data) } # }"},{"path":"https://github.com/team113sanger/sgeasy/reference/write_waterfall_plots.html","id":null,"dir":"Reference","previous_headings":"","what":"Write waterfall plots to files — write_waterfall_plots","title":"Write waterfall plots to files — write_waterfall_plots","text":"Saves nested list plots PNG files.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/write_waterfall_plots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write waterfall plots to files — write_waterfall_plots","text":"","code":"write_waterfall_plots(   plot_list,   output_dir = \"results\",   width = 900,   height = 600 )"},{"path":"https://github.com/team113sanger/sgeasy/reference/write_waterfall_plots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write waterfall plots to files — write_waterfall_plots","text":"plot_list named list plot lists (typically plot_all_conditions() applied multiple targetons). output_dir Directory write plots (default: \"results\"). width Plot width pixels (default: 900). height Plot height pixels (default: 600).","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/write_waterfall_plots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write waterfall plots to files — write_waterfall_plots","text":"Invisibly returns NULL. Side effect: writes PNG files.","code":""},{"path":"https://github.com/team113sanger/sgeasy/reference/write_waterfall_plots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write waterfall plots to files — write_waterfall_plots","text":"","code":"if (FALSE) { # \\dontrun{ write_waterfall_plots(plot_list, output_dir = \"figures\") } # }"}]
